

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="webpack的配置详解">
<meta property="og:type" content="article">
<meta property="og:title" content="webpack的学习笔记">
<meta property="og:url" content="http://example.com/2022/05/26/%E5%B7%A5%E4%BD%9C%E5%8C%BA/%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7/webpack/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Hbisedm">
<meta property="og:description" content="webpack的配置详解">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231142593.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231315690.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231325070.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231326503.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231328252.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231350963.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231350894.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231350655.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231353436.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232152401.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232153431.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232157510.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232200062.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232209665.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232210236.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232216849.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232229726.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232235041.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232235259.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232241685.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205241746490.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242014028.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242017543.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242137883.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242144666.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242146270.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242150679.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242210825.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242213981.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242217123.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242219808.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242222950.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242241759.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205250938820.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205250942779.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251135864.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251136951.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251137109.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251139553.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251143190.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251145295.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251147631.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251148435.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251153162.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251154806.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251157540.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251158142.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251417793.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251418245.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251431236.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251430130.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251432226.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251456765.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251500854.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251507862.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251510988.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251513762.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251519848.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251637866.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251638111.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251638135.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251638233.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251640876.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251645989.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251645513.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251724859.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251729343.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251730985.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251737649.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251741433.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251745492.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252036845.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252048587.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252047617.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252056115.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252058360.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252101845.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252105435.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252116129.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252123105.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252152334.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252155581.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252159510.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252201010.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252203125.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252223683.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252224283.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261100336.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261130275.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261130255.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261151289.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261313517.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261326230.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261327251.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261510405.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261542858.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261544684.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261550802.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205262050464.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205271012605.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205271029332.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205271032174.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205271042701.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205282227861.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205282229082.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291305451.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291308306.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291310046.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291518013.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291519024.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291520476.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291523708.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291523658.png">
<meta property="article:published_time" content="2022-05-26T04:42:26.000Z">
<meta property="article:modified_time" content="2022-05-30T13:39:47.452Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="打包工具">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231142593.png">
  
  
  <title>webpack的学习笔记 - Hbisedm</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"mGYDP7QqwA4Ca7dCSS9lwnFK-gzGzoHsz","app_key":"iJMI77yt31LAEc08kJwuT12Y","server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.1.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Hbisedm</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/why/">
                <i class="iconfont icon-user-fill"></i>
                why
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="webpack的学习笔记">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-05-26 12:42" pubdate>
        May 26, 2022 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      64k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      532 分钟
    </span>
  

  
  
    
      <!-- LeanCloud 统计文章PV -->
      <span id="leancloud-page-views-container" class="post-meta" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="leancloud-page-views"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">webpack的学习笔记</h1>
            
            <div class="markdown-body">
              <p>#webpack #打包器 </p>
<h1 id="安装webpack"><a href="#安装webpack" class="headerlink" title="安装webpack"></a>安装webpack</h1><figure class="highlight bash"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs bash">npm i webpack webpack-cli -g<br></code></pre></td></tr></table></figure>

<p>一般都在本地安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i webpack webpack-cli --save-dev<br></code></pre></td></tr></table></figure>

<h1 id="使用webpack"><a href="#使用webpack" class="headerlink" title="使用webpack"></a>使用webpack</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">webpack --entry ./src/index.js --mode production<br></code></pre></td></tr></table></figure>

<p>发现每次都在命令行输入配置不方便，使用webpack.config.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;bundle.js&#x27;</span>,<br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>)<br>    &#125;,<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;none&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>最简单的配置webpack</p>
<p>运行<code>npx webpack</code> 打包生成bundle.js</p>
<h2 id="自动引入资源"><a href="#自动引入资源" class="headerlink" title="自动引入资源"></a>自动引入资源</h2><p>引入一个插件html-webpack-plugin，可以自动生成html入口文件和引用js文件的功能，通过配置html模板 、js标签位置、生成的html名称等等功能</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>);<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;bundle.js&#x27;</span>,<br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>),<br>        <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">//每次生成后清理上一次的打包文件列表</span><br>    &#125;,<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;none&#x27;</span>,<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>            <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;./index.html&#x27;</span>,<br>            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;app.html&#x27;</span>,<br>            <span class="hljs-attr">inject</span>: <span class="hljs-string">&#x27;body&#x27;</span><br>        &#125;)<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="webpack-dev-server"><a href="#webpack-dev-server" class="headerlink" title="webpack-dev-server"></a>webpack-dev-server</h2><p>配置文件中mode改为development</p>
<p>使用source map功能，可以精准定位代码</p>
<p>使用watch mode，可以监听代码的变化，但是还是要手动刷新浏览器</p>
<p>使用webpack-dev-server，不但能监听文件的文化从而重新编译，还可以自动帮我们刷新浏览器</p>
<h1 id="资源模块-asset-modules"><a href="#资源模块-asset-modules" class="headerlink" title="资源模块(asset modules)"></a>资源模块(asset modules)</h1><p>四种类型资源</p>
<ul>
<li>asset&#x2F;resource 他会发送一个单独的文件并导出URL（文件地址URL）</li>
<li>asset&#x2F;inline 导出一个资源的Data URL（Base64）</li>
<li>asset&#x2F;source 导出资源的源代码 （copy的理解）</li>
<li>asset 导出一个Data URL和发送一个单独文件之间进行选择</li>
</ul>
<h3 id="Resource资源"><a href="#Resource资源" class="headerlink" title="Resource资源"></a>Resource资源</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs jsx">&#123;<br>             <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\\.png$/</span>,<br>             <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset/resource&#x27;</span>,<br>             <span class="hljs-attr">generator</span>: &#123;<br>                 <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;images/test.png&#x27;</span><br>             &#125;<br>         &#125;,<br></code></pre></td></tr></table></figure>

<h3 id="Inline资源"><a href="#Inline资源" class="headerlink" title="Inline资源"></a>Inline资源</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jsx">&#123;<br>             <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\\.svg$/</span>,<br>             <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset/inline&#x27;</span><br>         &#125;,<br></code></pre></td></tr></table></figure>

<h3 id="Source资源"><a href="#Source资源" class="headerlink" title="Source资源"></a>Source资源</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jsx">&#123;<br>             <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\\.txt$/</span>,<br>             <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset/source&#x27;</span><br>         &#125;,<br></code></pre></td></tr></table></figure>

<h3 id="Asset资源"><a href="#Asset资源" class="headerlink" title="Asset资源"></a>Asset资源</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs jsx">&#123;<br>             <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\\.jpg$/</span>,<br>             <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset&#x27;</span>,<br>             <span class="hljs-attr">parser</span>: &#123;<br>                 <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>                     <span class="hljs-attr">maxSize</span>: <span class="hljs-number">2</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span><br>                 &#125;<br>             &#125;<br>         &#125;<br></code></pre></td></tr></table></figure>

<h1 id="Loader"><a href="#Loader" class="headerlink" title="Loader"></a>Loader</h1><p>webpack只能解析js和json，其他文件类型的如css、ts、txt等等可以使用loader</p>
<h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><h3 id="普通css"><a href="#普通css" class="headerlink" title="普通css"></a>普通css</h3><p>安装css-loader帮助webpack可以识别项目中使用import、require css文件</p>
<p>安装style-loader帮助webpack可以讲css文件的内容放到到页面上</p>
<p>2个同时使用的时候，顺序如下，webpack的loader使用顺序是从右往左走的，先用css加载完成后，再将css代码加入到页面内</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>          <span class="hljs-attr">use</span>: [<span class="hljs-string">&#x27;style-loader&#x27;</span>, <span class="hljs-string">&#x27;css-loader&#x27;</span>]<br>      &#125;<br></code></pre></td></tr></table></figure>

<h3 id="Less"><a href="#Less" class="headerlink" title="Less"></a>Less</h3><p> <code>npm install less-loader less -D</code> 先进行预处理为css，再走css-loader, style-loader</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(css|less)$/</span>,<br>    <span class="hljs-attr">use</span>: [<span class="hljs-string">&#x27;style-loader&#x27;</span>, <span class="hljs-string">&#x27;css-loader&#x27;</span>, <span class="hljs-string">&#x27;less-loader&#x27;</span>]<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="抽离与压缩CSS文件"><a href="#抽离与压缩CSS文件" class="headerlink" title="抽离与压缩CSS文件"></a>抽离与压缩CSS文件</h3><p>安装<strong>webpack5</strong>中的插件mini-css-extract-plugin ，进行html与css代码的抽离</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// Webpack.config.js</span><br><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mini-css-extract-plugin&#x27;</span>);<br><br><span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>            <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;./index.html&#x27;</span>,<br>            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;app.html&#x27;</span>,<br>            <span class="hljs-attr">inject</span>: <span class="hljs-string">&#x27;body&#x27;</span><br>        &#125;),<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>()<br>    ],<br> <br>  <span class="hljs-comment">// 最后的style-loader 改为 MiniCssExtractPlugin.loader</span><br>  					&#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(css|less)$/</span>,<br>                <span class="hljs-attr">use</span>: [<span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>, <span class="hljs-string">&#x27;css-loader&#x27;</span>, <span class="hljs-string">&#x27;less-loader&#x27;</span>]<br>            &#125;<br></code></pre></td></tr></table></figure>

<p>使用npx webpack 运行后，</p>
<ul>
<li>发现dist文件夹下多了个main.css</li>
<li>app.html内也没有了style标签多了个link标签引入了这个main.css，也就是html与css分离了</li>
</ul>
<h4 id="更改文件夹与文件名"><a href="#更改文件夹与文件名" class="headerlink" title="更改文件夹与文件名"></a>更改文件夹与文件名</h4><p>配置MiniCssExtractPlugin</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>  <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;styles/[contentHash].css&#x27;</span><br>&#125;)<br></code></pre></td></tr></table></figure>

<h4 id="压缩CSS"><a href="#压缩CSS" class="headerlink" title="压缩CSS"></a>压缩CSS</h4><p><code>npm install css-minimizer-webpack-plugin -D </code> 安装压缩插件（同样的这个也是在<strong>webpack5</strong>版本下才有的功能）</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span> webpack.config.js<br><br><span class="hljs-regexp">//</span> 引入插件常量<br>const CssMinimizerPlugin = require(<span class="hljs-string">&#x27;css-minimizer-webpack-plugin&#x27;</span>);<br><br><span class="hljs-regexp">//</span>  mode为生产，生产环境才压缩代码嘛<br> mode: <span class="hljs-string">&#x27;production&#x27;</span>,<br> <br> <span class="hljs-regexp">//</span> 加入优化选项<br> optimization: &#123;<br>        minimizer: [<br>            new CssMinimizerPlugin()<br>        ]<br>    &#125;<br></code></pre></td></tr></table></figure>



<h2 id="加载images图像"><a href="#加载images图像" class="headerlink" title="加载images图像"></a>加载images图像</h2><p>有些background与icon的图像引进到CSS文件中，webpack5中，使用内置的资源模块(Asset Modules)，可以轻松将这些内容混入我们的系统中，这个在[资源模块](# 资源模块(asset modules))中就介绍了。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.block-bg</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&#x27;./assets/inline.svg&#x27;</span>) <span class="hljs-meta">!important</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> block = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>)<br>block.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;block-bg&#x27;</span>)<br>block.<span class="hljs-property">textContent</span> = txtsrc<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231142593.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="加载fonts字体"><a href="#加载fonts字体" class="headerlink" title="加载fonts字体"></a>加载fonts字体</h2><p>在css3后加入webfont字库，</p>
<p>资源模块可以帮助我们加载任何东西，包括字体，尝试用之前的资源模块去加载我们指定的字体文件</p>
<p>去阿里的字体库随意下载个图标字体代码，目的是为了引入个iconfont.ttf</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// Webpack.config.js 中配置</span><br>            &#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(woff|woff2|eot|ttf|otf)$/</span>,<br>                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset/resource&#x27;</span>,<br>            &#125;<br><br></code></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs css">// css中加入<span class="hljs-attribute">font</span>-face 加载引用的字体文件，可以本地，可以在线 <span class="hljs-attribute">font-family</span> 定义自定义字体的名称<br>// 后面的<span class="hljs-selector-class">.icon</span>类名使用自定义字体的名称去使用<br><br><span class="hljs-keyword">@font-face</span> &#123;<br>    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">&#x27;hbisedm&#x27;</span>;<br>    <span class="hljs-attribute">src</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&#x27;./assets/iconfont.ttf&#x27;</span>) <span class="hljs-built_in">format</span>(<span class="hljs-string">&#x27;truetype&#x27;</span>);<br>&#125;<br><br><span class="hljs-selector-class">.icon</span> &#123;<br>    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">&#x27;hbisedm&#x27;</span>;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">30px</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231315690.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="加载数据"><a href="#加载数据" class="headerlink" title="加载数据"></a>加载数据</h2><p>JSON、CSV、TSV、XML等等</p>
<p>安装对应依赖  <code>npm install csv-loader xml-loader -D</code></p>
<p>准备2个文件(xml、csv)</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231325070.png" srcset="/img/loading.gif" lazyload alt="image-20220523132540279"></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231326503.png" srcset="/img/loading.gif" lazyload alt="image-20220523132601067"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//webpack.config.js</span><br>						&#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(csv|tsv)$/</span>,<br>                <span class="hljs-attr">use</span>: <span class="hljs-string">&#x27;csv-loader&#x27;</span>,<br>            &#125;,<br>            &#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.xml$/</span>,<br>                <span class="hljs-attr">use</span>: <span class="hljs-string">&#x27;xml-loader&#x27;</span>,<br>            &#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// index.js</span><br><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Data</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./assets/data.xml&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Nodes</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./assets/data.csv&#x27;</span><br><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Data</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Nodes</span>);<br></code></pre></td></tr></table></figure>

<p>运行webpack-dev-server，发现xml变成了对象，而csv变成了个数组</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231328252.png" srcset="/img/loading.gif" lazyload alt="image-20220523132825192"></p>
<h2 id="自定义JSON模块parser"><a href="#自定义JSON模块parser" class="headerlink" title="自定义JSON模块parser"></a>自定义JSON模块parser</h2><p>安装依赖 <code>npm install toml yaml json5 -D</code></p>
<p>将类似json格式的文件转成json</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// webpack.config.js</span><br>						&#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.toml$/</span>,<br>                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;json&#x27;</span>,<br>                <span class="hljs-attr">parser</span>: &#123;<br>                    <span class="hljs-attr">parse</span>: toml.<span class="hljs-property">parse</span><br>                &#125;<br>            &#125;,<br>            &#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.yaml$/</span>,<br>                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;json&#x27;</span>,<br>                <span class="hljs-attr">parser</span>: &#123;<br>                    <span class="hljs-attr">parse</span>: yaml.<span class="hljs-property">parse</span><br>                &#125;<br>            &#125;,<br>            &#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.json5$/</span>,<br>                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;json&#x27;</span>,<br>                <span class="hljs-attr">parser</span>: &#123;<br>                    <span class="hljs-attr">parse</span>: json5.<span class="hljs-property">parse</span><br>                &#125;<br>            &#125;,<br><br></code></pre></td></tr></table></figure>

<p>每种不同格式的文件内容如下图：</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231350963.png" srcset="/img/loading.gif" lazyload alt="image-20220523135014257"></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231350894.png" srcset="/img/loading.gif" lazyload alt="image-20220523135037836"></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231350655.png" srcset="/img/loading.gif" lazyload alt="image-20220523135055609"></p>
<p>webpack配置文件配置loader后，我们就可以在js文件内引入这些文件了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// index.js</span><br><br><span class="hljs-keyword">import</span> toml <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./assets/data.toml&#x27;</span><br><span class="hljs-keyword">import</span> yaml <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./assets/data.yaml&#x27;</span><br><span class="hljs-keyword">import</span> json5 <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./assets/data.json5&#x27;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;toml&#x27;</span>, toml);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(toml.<span class="hljs-property">title</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(toml.<span class="hljs-property">owner</span>.<span class="hljs-property">name</span>);<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;yaml&#x27;</span>, yaml);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(yaml.<span class="hljs-property">title</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(yaml.<span class="hljs-property">owner</span>.<span class="hljs-property">name</span>);<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;json5&#x27;</span>, json5);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json5.<span class="hljs-property">title</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json5.<span class="hljs-property">owner</span>.<span class="hljs-property">name</span>);<br></code></pre></td></tr></table></figure>

<p>获取的数据为JavaScript对象的格式</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205231353436.png" srcset="/img/loading.gif" lazyload alt="image-20220523135330391"></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>除了使用前面的[资源模块](# 资源模块(asset modules))可以去引用外部资源文件，我们还可以使用Loader这个配置属性去配置我们想要引入的外部资源文件。</p>
<p>如css文件，我们可以使用style-loader和css-loader去加载css外部资源文件，并将css代码放在了head标签内的style标签，接着使用sass-loader、less-loader去引入css预处理工具，接着使用 <code>MiniCssExtractPlugin</code> 插件可以将我们css代码和html文件进行分离css代码并自定义生成的css名称与路径；使用 <code>CssMinimizerPlugin</code> 插件可以将css代码进行压缩。 通过资源模块的配置去加载图片资源，在css中引入相应的图片资源。利用 <code>asset/resource</code> 去加载字体文件 从而使webpack可以打包iconfont。对于一些数据如csv、xml，JavaScript自然也是不会识别的，但是通过webpack这个加入相应的loader也是可以做到解析数据出来的。对一些json格式的同类文件如yaml、json5等等，加入对应的loader进行解析。</p>
<h1 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h1><h2 id="babel-loader"><a href="#babel-loader" class="headerlink" title="babel-loader"></a>babel-loader</h2><p>webpack中使用babel-loader将es6语法降低以致于适配低版本的浏览器</p>
<p><code>npm install babel-loader @babel/core @babel/preset-env -D</code></p>
<ul>
<li><code>babel-loader</code>: 在webpack里应用babel解析ES6的桥梁</li>
<li><code>@babel/core</code>: babel核心模块</li>
<li><code>@babel/preset-env</code>: babel预设，一组babel插件的集合（babel我要配置好多东西，如果有预设，就一条代码就等于配置了很多东西）</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//webpack.config.js</span><br>					 &#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>                <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,<br>                <span class="hljs-attr">use</span>:&#123;<br>                    <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;babel-loader&#x27;</span>,<br>                    <span class="hljs-attr">options</span>: &#123;<br>                        <span class="hljs-attr">presets</span>: [<span class="hljs-string">&#x27;@babel/preset-env&#x27;</span>]<br>                    &#125;<br>                &#125;<br>            &#125;<br></code></pre></td></tr></table></figure>



<p>发现aysnc&#x2F;await语法不起作用，少了个<strong>regeneratorRuntime</strong></p>
<h2 id="regeneratorRuntime"><a href="#regeneratorRuntime" class="headerlink" title="regeneratorRuntime"></a>regeneratorRuntime</h2><p><strong>regeneratorRuntime</strong> 是 webpack 打包生成的全局辅助函数，由 babel 生成，用于兼容 async&#x2F;await 等高级语法。</p>
<p><code>npm i @babel/runtime @babel/plugin-transform-runtime -D</code></p>
<h2 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h2><p>webpack天生可以加载js模块化，但是只是个打包器，并不难转化js语法，这个时候就需要个babel</p>
<p>babel与webpack的结合就需要个babel-loader</p>
<h1 id="代码分离"><a href="#代码分离" class="headerlink" title="代码分离"></a>代码分离</h1><h2 id="入口起点"><a href="#入口起点" class="headerlink" title="入口起点"></a>入口起点</h2><p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232152401.png" srcset="/img/loading.gif" lazyload alt="image-20220523215248342"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">entry</span>: &#123;<br>      <span class="hljs-attr">index</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>      <span class="hljs-attr">another</span>: <span class="hljs-string">&#x27;./src/another-module.js&#x27;</span><br>  &#125;,<br><br>  <span class="hljs-attr">output</span>: &#123;<br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;[name].bundle.js&#x27;</span>,<br>  &#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232153431.png" srcset="/img/loading.gif" lazyload alt="image-20220523215358378"></p>
<p>分析下代码</p>
<ul>
<li>another中引入了lodash文件。</li>
<li>index中使用了babel-loader，会把一些js代码打进去。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232157510.png" srcset="/img/loading.gif" lazyload alt="image-20220523215709452"></p>
<p>app.html 中加入了我们刚才entry入口配置的那2个bundle.js </p>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><p>我们在index中也使用lodash</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//index.js</span><br><br><span class="hljs-keyword">import</span> _ <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;lodash&#x27;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(_.<span class="hljs-title function_">join</span>([<span class="hljs-string">&#x27;index&#x27;</span>, <span class="hljs-string">&#x27;module&#x27;</span>, <span class="hljs-string">&#x27;loaded&#x27;</span>]));<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232200062.png" srcset="/img/loading.gif" lazyload alt="image-20220523220031994"></p>
<p>我们发现2个js文件，体积都变大了</p>
<p>本来lodash是一个共享的js文件，但是我们使用这种<strong>多入口</strong>文件打包方式，导致我们打包后的体积变大了。</p>
<p>导致问题：入口的chuck之间有共享代码，打包后的bundle文件导致体积大的</p>
<h2 id="防止重复代码"><a href="#防止重复代码" class="headerlink" title="防止重复代码"></a>防止重复代码</h2><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>配置webpack.config.js的入口文件，加入个dependOn参数，这个参数又指向一个共享资源文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">entry</span>: &#123;<br>      <span class="hljs-attr">index</span>: &#123;<br>          <span class="hljs-attr">import</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>          <span class="hljs-attr">dependOn</span>: <span class="hljs-string">&#x27;shared&#x27;</span><br>      &#125;,<br>      <span class="hljs-attr">another</span>: &#123;<br>          <span class="hljs-attr">import</span>: <span class="hljs-string">&#x27;./src/another-module.js&#x27;</span>,<br>          <span class="hljs-attr">dependOn</span>: <span class="hljs-string">&#x27;shared&#x27;</span><br>      &#125;,<br>      <span class="hljs-attr">shared</span>: <span class="hljs-string">&#x27;lodash&#x27;</span><br>  &#125;,<br></code></pre></td></tr></table></figure>

<p>意思就是说，当我们这2个模块(index、another)中，有lodash这个模块，就会把它抽离出来，并命名为shared的chunk</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232209665.png" srcset="/img/loading.gif" lazyload alt="image-20220523220928618"></p>
<p>发现生成的文件变成3个js文件</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232210236.png" srcset="/img/loading.gif" lazyload alt="image-20220523221050175"></p>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>使用webpack的插件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs webpack.config.js">	entry: &#123;<br>      // index: &#123;<br>      //     import: &#x27;./src/index.js&#x27;,<br>      //     dependOn: &#x27;shared&#x27;<br>      // &#125;,<br>      // another: &#123;<br>      //     import: &#x27;./src/another-module.js&#x27;,<br>      //     dependOn: &#x27;shared&#x27;<br>      // &#125;,<br>      // shared: &#x27;lodash&#x27;<br>      index: &#x27;./src/index.js&#x27;,<br>      another: &#x27;./src/another-module.js&#x27;,<br>  &#125;,<br>  <br>optimization: &#123;<br>      splitChunks: &#123;<br>          chunks: &#x27;all&#x27;,<br>      &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232216849.png" srcset="/img/loading.gif" lazyload alt="image-20220523221631783"></p>
<p>使用这种方式多了2个webpack生成的文件，</p>
<h2 id="动态引入-异步导入"><a href="#动态引入-异步导入" class="headerlink" title="动态引入(异步导入)"></a>动态引入(异步导入)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// async-module.js</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getComponent</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;lodash&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">&#123;<span class="hljs-keyword">default</span>: _&#125;</span>)=&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);<br>        div.<span class="hljs-property">innerHTML</span> = _.<span class="hljs-title function_">join</span>([<span class="hljs-string">&#x27;Hello&#x27;</span>, <span class="hljs-string">&#x27;webpack&#x27;</span>], <span class="hljs-string">&#x27; &#x27;</span>);<br>        <span class="hljs-keyword">return</span> div<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">getComponent</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">component</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(component)<br>&#125;)<br><br><span class="hljs-comment">// index.js</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;./async-module&#x27;</span><br><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232229726.png" srcset="/img/loading.gif" lazyload alt="image-20220523222936656"></p>
<p>发现这种import写法，webpack可以帮我们分离引入的代码</p>
<p>一旦我们静态资源文件中也加入了lodash模块</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//index.js </span><br><br><span class="hljs-keyword">import</span> _ <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;lodash&#x27;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(_.<span class="hljs-title function_">join</span>([<span class="hljs-string">&#x27;index&#x27;</span>, <span class="hljs-string">&#x27;module&#x27;</span>, <span class="hljs-string">&#x27;loaded&#x27;</span>]));<br></code></pre></td></tr></table></figure>

<p>运行<code>npx webpack</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232235041.png" srcset="/img/loading.gif" lazyload alt="image-20220523223557987"></p>
<p>发现我们打包的2个文件，变成了一个index.bundle.js，也就是说一旦静态资源引用了同一个模块，就没了webpack刚才帮我们自动打包的引入的文件，也就没了代码分离了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//webpack.config.js</span><br>				<span class="hljs-attr">splitChunks</span>: &#123;<br>            <span class="hljs-attr">chunks</span>: <span class="hljs-string">&#x27;all&#x27;</span>,<br>        &#125;<br></code></pre></td></tr></table></figure>

<p>将这个配置打开后。又回到了代码分离的情况了～</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232235259.png" srcset="/img/loading.gif" lazyload alt="image-20220523223509193"></p>
<p><strong>这个时候，也就是我们所谓的动态导入与静态导入都可以代码分离出来</strong></p>
<p>再将一开始的another文件入口也打开</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css">entry: &#123;<br>      index: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>      another: <span class="hljs-string">&#x27;./src/another-module.js&#x27;</span>,<br>      &#125;<br></code></pre></td></tr></table></figure>

<p><code>npx webpack</code>运行</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205232241685.png" srcset="/img/loading.gif" lazyload alt="image-20220523224147612"></p>
<p>发现还是一样的情况，公共的模块抽离出来了！！！！！</p>
<h3 id="懒加载"><a href="#懒加载" class="headerlink" title="懒加载"></a>懒加载</h3><p>当我们需要这个js文件的时候才去服务器拿</p>
<p>新建个math.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">x, y</span>) =&gt;  x + y <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">min</span> = (<span class="hljs-params">x, y</span>) =&gt;  x - y <br></code></pre></td></tr></table></figure>

<p>在index.js中使用math的add方法（以动态引入的方式）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;button&#x27;</span>)<br>button.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;点击执行加法运算&#x27;</span><br>button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123; <br>    <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;./math&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">&#123; add &#125;</span>) =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(add)<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>))<br>    &#125;)<br> &#125;)<br><br> <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(button)<br></code></pre></td></tr></table></figure>

<p>webpack打包后生成了个<code>src_math_js.bundle.js</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205241746490.png" srcset="/img/loading.gif" lazyload></p>
<p>当点击按钮后，当前网页才会去加载这个JS文件，达到了按需加载与代码分离的情况</p>
<p>我们当然也可以自定义这个bundleJs的名字</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// webpack的魔法注释</span><br>button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123; <br>    <span class="hljs-title function_">import</span>(<span class="hljs-comment">/* webpackChunkName: &#x27;math&#x27; */</span><span class="hljs-string">&#x27;./math&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">&#123; add &#125;</span>) =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(add)<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>))<br>    &#125;)<br> &#125;)<br></code></pre></td></tr></table></figure>

<p>打包后就变成了<code>math.bundle.js</code></p>
<h3 id="预获取和预加载"><a href="#预获取和预加载" class="headerlink" title="预获取和预加载"></a>预获取和预加载</h3><p>Webpack v4.6.0+ 增加了对预获取和预加载的支持。</p>
<p>在声明 import 时，使用下面这些内置指令，可以让 webpack输出 “resource hint(资源提示），来告知浏览器：</p>
<ul>
<li>prefetch(预获取)：将来某些导航下可能需要的资源</li>
<li>preload(预加载)：当前导航下可能需要资源</li>
</ul>
<h4 id="prefetch"><a href="#prefetch" class="headerlink" title="prefetch"></a>prefetch</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123; <br>    <span class="hljs-title function_">import</span>(<span class="hljs-comment">/* webpackChunkName: &#x27;math&#x27;, webpackPrefetch: true */</span><span class="hljs-string">&#x27;./math&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">&#123; add &#125;</span>) =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(add)<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>))<br>    &#125;)<br> &#125;)<br></code></pre></td></tr></table></figure>

<p>打包后，发现每次刷新网页都会去加载这个math.bundle.js</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242014028.png" srcset="/img/loading.gif" lazyload></p>
<p>这个是浏览器的link的prefetch，当我们浏览器加载所有文件后，网络若空闲了，就会去加载prefetch的对应资源</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242017543.png" srcset="/img/loading.gif" lazyload alt="image-20220524201703506"></p>
<p>当点击按钮后，再去加载我们的math.bundle.js，但此时这个文件其实已经下载好了。  </p>
<h4 id="preload"><a href="#preload" class="headerlink" title="preload"></a>preload</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123; <br>    <span class="hljs-title function_">import</span>(<span class="hljs-comment">/* webpackChunkName: &#x27;math&#x27;, webpackPreload: true */</span><span class="hljs-string">&#x27;./math&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">&#123; add &#125;</span>) =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(add)<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>))<br>    &#125;)<br> &#125;)<br></code></pre></td></tr></table></figure>

<p>效果与懒加载类似</p>
<h2 id="小结-2"><a href="#小结-2" class="headerlink" title="小结"></a>小结</h2><p>代码分离是webpack一个好用的地方，将主文件分离出来，减少主文件的大小，从而<strong>提高首屏的加载速度。</strong></p>
<p>分离代码有三种方法</p>
<ul>
<li>入口起点配置（配置多入口实现代码的分离）</li>
<li>防止重复（也是在入口起点配置，不过可以将一个共享资源文件抽离出来一个bundle，从而防止代码的重复打包）</li>
<li>动态导入｜异步导入（使用ES6的导入模块的方法import来实现代码的分离）<ul>
<li>懒加载（编译的时候把模块打包好，在浏览器中，需要的时候再去加载，达到<strong>按需加载</strong>）</li>
<li>预获取和预加载（编译的时候把模块打包好，浏览器网络空闲时，去下载，省去了将来模块加载的延迟速度；preload实现页面模块的<strong>并行加载</strong>）</li>
</ul>
</li>
</ul>
<h1 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h1><h2 id="输出文件的文件名"><a href="#输出文件的文件名" class="headerlink" title="输出文件的文件名"></a>输出文件的文件名</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">output</span>: &#123;<br>       <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;[name].bundle.js&#x27;</span>,<br>       <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>),<br>       <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>       <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&#x27;images/[name][hash:8][ext]&#x27;</span>,<br>   &#125;,<br></code></pre></td></tr></table></figure>

<blockquote>
<p>第一次打包后生成的文件名叫做xxxx.bundle.js，如果第二次打包前，我们修改了某个文件内容，这时候打包后输出的文件名还是叫做xxxx.bundle.js，由于浏览器有缓存机制，它会认为我们的文件并没有修改，使用上一份xxxx.bundle.js</p>
</blockquote>
<p><strong>[name].bundle.js</strong> 中name这种称为<code>substitution</code> 可替换的模板字符串</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;[name].[contenthash].js&#x27;</span>,<br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>),<br>        <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&#x27;images/[name][hash:8][ext]&#x27;</span>,<br>    &#125;,<br></code></pre></td></tr></table></figure>

<p>这样就会根据文件内容生成不同的hash值，从而我们文件名会根据文件内容的修改，而生成不同的文件名。这样就不怕浏览器缓存了。</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242137883.png" srcset="/img/loading.gif" lazyload alt="image-20220524213700813"></p>
<p>上面的操作是操作我们自己写的js文件，而大部分情况，项目需要引入第三方js文件。</p>
<h2 id="缓存第三方库"><a href="#缓存第三方库" class="headerlink" title="缓存第三方库"></a>缓存第三方库</h2><p>将第三方库(ibrary)（例如 Lodash ）提取到单独的 vendor chunk 文件中，是比较推荐的做法，这是因为，它们很少像本地的源代码那样频繁修改。因此通过实现以上步骤，利用 client 的长效缓存机制，命中缓存来消除请求，并减少向 server获取资源，同时还能保证 client 代码和 server 代码版本一致。我们在optimization.splitchunks 添加如下 cacheGroups 参数并构建：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js">				<span class="hljs-attr">splitChunks</span>: &#123;<br>         <span class="hljs-attr">chunks</span>: <span class="hljs-string">&#x27;all&#x27;</span> <br>        &#125;<br><br><span class="hljs-comment">// 改为下面</span><br><br>				<span class="hljs-attr">splitChunks</span>: &#123;<br>            <span class="hljs-attr">cacheGroups</span>: &#123; <span class="hljs-comment">//缓存组</span><br>                <span class="hljs-attr">vendor</span>: &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>, <span class="hljs-comment">//将node_modules的缓存</span><br>                    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;vendors&#x27;</span>,<br>                    <span class="hljs-attr">chunks</span>: <span class="hljs-string">&#x27;all&#x27;</span><br>                &#125;<br>            &#125;<br>        &#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242144666.png" srcset="/img/loading.gif" lazyload alt="image-20220524214448600"></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242146270.png" srcset="/img/loading.gif" lazyload alt="image-20220524214650211"></p>
<p>可以发现第三方的包都打到了一个vendors.[contenthash].js内</p>
<h2 id="将所有的js文件放到一个文件夹下"><a href="#将所有的js文件放到一个文件夹下" class="headerlink" title="将所有的js文件放到一个文件夹下"></a>将所有的js文件放到一个文件夹下</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">output</span>: &#123;<br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;scripts/[name].[contenthash].js&#x27;</span>, <span class="hljs-comment">//加入`scripts/` 目录</span><br>      <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>),<br>      <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&#x27;images/[name][hash:8][ext]&#x27;</span>,<br>  &#125;,<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242150679.png" srcset="/img/loading.gif" lazyload alt="image-20220524215020607"></p>
<h2 id="小结-3"><a href="#小结-3" class="headerlink" title="小结"></a>小结</h2><p>当我们打包好后的文件，自然要放到服务器上，浏览器访问服务器上的资源文件，会有个缓存机制！</p>
<p>这样呢，如果修改了业务代码，但是对应的js文件名不变的话，会使用浏览器本地缓存好的文件。这样就有错误！拿不到最新的内容</p>
<ul>
<li>修改输出文件的文件名来解决这个问题  使用可替换模版字符串的方法来替换</li>
<li>缓存第三方库 通过修改<code>optimization.splitChunks</code>这个属性来实现，使用cacheGroups缓存组，将我们使用第三方代码都打包到同一个文件内，在浏览器缓存，由于这个文件不频繁更新，所以可以提高首屏加载速度。</li>
<li>将所有js打包到同一个文件夹中，以致样式、脚本、文本、图片各个不同类型的资源文件放到不同的文件夹中。</li>
</ul>
<h1 id="拆分开发环境和生产环境的配置"><a href="#拆分开发环境和生产环境的配置" class="headerlink" title="拆分开发环境和生产环境的配置"></a>拆分开发环境和生产环境的配置</h1><blockquote>
<p>现在的我，只会手工的修改mode来切换开发环境和生产环境</p>
</blockquote>
<p>但是有些配置在生产环境和开发环境是不一样的，如dev环境不需要设置缓存，而生产环境需要设置公共路径等等情况。</p>
<h2 id="公共路径-publicPath"><a href="#公共路径-publicPath" class="headerlink" title="公共路径(publicPath)"></a>公共路径(publicPath)</h2><p>使用publicPath来指定应用程序中所有资源的基础路径</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242210825.png" srcset="/img/loading.gif" lazyload alt="image-20220524221039765"></p>
<p>我们可不可以使用cdn或者自定义服务器的路径去指定呢？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;scripts/[name].[contenthash].js&#x27;</span>,<br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>),<br>        <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&#x27;images/[name][hash:8][ext]&#x27;</span>,<br>        <span class="hljs-attr">publicPath</span>: <span class="hljs-string">&#x27;http://localhost:8080/&#x27;</span> <span class="hljs-comment">// 添加publicPath</span><br>    &#125;,<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242213981.png" srcset="/img/loading.gif" lazyload alt="image-20220524221330916"></p>
<p>这个域名我们指定为cdn域名或者前端项目的域名</p>
<h2 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h2><p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242217123.png" srcset="/img/loading.gif" lazyload alt="image-20220524221700060"></p>
<p>修改webpack.config.js为函数形式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npx webpack --<span class="hljs-built_in">env</span> production --<span class="hljs-built_in">env</span> devCoder=Hbisedm                                             <br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242219808.png" srcset="/img/loading.gif" lazyload alt="image-20220524221919740"></p>
<p>这样就可以拿到我们定好的环境变量</p>
<p>这样我们就可以灵活使用变量做一些事情了。</p>
<p>我们如何压缩打包好js代码，其实webpack自带了个开箱即用的terser的，那为什么现在代码还是没有压缩呢？</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242222950.png" srcset="/img/loading.gif" lazyload alt="image-20220524222253893"></p>
<p>原因是我们webpack.config.js使用CSS压缩，这种情况terser就得我们自己去单独配置才可以生效</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install terser-webpack-plugin -D<br></code></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;terser-webpack-plugin&#x27;</span>)<br> 				<br>				<span class="hljs-attr">mode</span>: env.<span class="hljs-property">production</span> ? <span class="hljs-string">&#x27;production&#x27;</span> : <span class="hljs-string">&#x27;development&#x27;</span>,<br><br>				<span class="hljs-attr">optimization</span>: &#123;<br>						<span class="hljs-attr">minimizer</span>: [<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserPlugin</span>() <span class="hljs-comment">//加入这个插件，达到js压缩(prod环境下)</span><br>            ],<br>         &#125;<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npx webpack --<span class="hljs-built_in">env</span> production<br></code></pre></td></tr></table></figure>

<p>打包后的js代码压缩</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npx webpack --<span class="hljs-built_in">env</span> development<br></code></pre></td></tr></table></figure>

<p>打包后的js代码未压缩</p>
<p><strong>这就是我们环境变量的意义</strong></p>
<h2 id="拆分配置文件"><a href="#拆分配置文件" class="headerlink" title="拆分配置文件"></a>拆分配置文件</h2><p>创建个conifg文件夹下创建个webpack.config.dev.js </p>
<p>.&#x2F;config&#x2F;webpack.config.dev.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mini-css-extract-plugin&#x27;</span>);<br><br><span class="hljs-comment">// const CssMinimizerPlugin = require(&#x27;css-minimizer-webpack-plugin&#x27;);</span><br><span class="hljs-comment">// const TerserPlugin = require(&#x27;terser-webpack-plugin&#x27;)</span><br><br><span class="hljs-keyword">const</span> toml = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;toml&#x27;</span>)<br><span class="hljs-keyword">const</span> yaml =<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;yaml&#x27;</span>)<br><span class="hljs-keyword">const</span> json5 = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;json5&#x27;</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>        <span class="hljs-attr">entry</span>: &#123;<br>            <span class="hljs-attr">index</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>            <span class="hljs-attr">another</span>: <span class="hljs-string">&#x27;./src/another-module.js&#x27;</span>,<br>        &#125;,<br>    <br>        <span class="hljs-attr">output</span>: &#123;<br>            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;scripts/[name].js&#x27;</span>, <span class="hljs-comment">//删掉[contentHash]缓存文件名</span><br>            <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>),<br>            <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&#x27;images/[name][hash:8][ext]&#x27;</span>,<br>            <span class="hljs-comment">// publicPath: &#x27;http://localhost:8080/&#x27; //dev环境 没必要</span><br>        &#125;,<br>        <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>, <span class="hljs-comment">//dev 肯定使用这个</span><br><br>        <span class="hljs-attr">devtool</span>: <span class="hljs-string">&#x27;inline-source-map&#x27;</span>, <span class="hljs-comment">//需要调试代码，这个是需要的</span><br>        <br>        <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>                <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;./index.html&#x27;</span>,<br>                <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;app.html&#x27;</span>,<br>                <span class="hljs-attr">inject</span>: <span class="hljs-string">&#x27;body&#x27;</span><br>            &#125;),<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>                <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;styles/[contenthash].css&#x27;</span><br>            &#125;)<br>        ],<br>        <span class="hljs-attr">devServer</span>: &#123; <span class="hljs-comment">// dev环境肯定需要这个</span><br>            <span class="hljs-attr">static</span>: <span class="hljs-string">&#x27;./dist&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">module</span>: &#123;<br>            <span class="hljs-attr">rules</span>: [<br>                &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.png$/</span>,<br>                    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset/resource&#x27;</span>,<br>                    <span class="hljs-attr">generator</span>: &#123;<br>                        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;images/test.png&#x27;</span><br>                    &#125;<br>                &#125;,<br>                &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.svg$/</span>,<br>                    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset/inline&#x27;</span><br>                &#125;,<br>                &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.txt$/</span>,<br>                    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset/source&#x27;</span><br>                &#125;,<br>                &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.jpg$/</span>,<br>                    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset&#x27;</span>,<br>                    <span class="hljs-attr">parser</span>: &#123;<br>                        <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>                            <span class="hljs-attr">maxSize</span>: <span class="hljs-number">2</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span><br>                        &#125;<br>                    &#125;<br>                &#125;,<br>    <br>                &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(css|less)$/</span>,<br>                    <span class="hljs-attr">use</span>: [<span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>, <span class="hljs-string">&#x27;css-loader&#x27;</span>, <span class="hljs-string">&#x27;less-loader&#x27;</span>]<br>                &#125;,<br>    <br>                &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(woff|woff2|eot|ttf|otf)$/</span>,<br>                    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset/resource&#x27;</span>,<br>                &#125;,<br>    <br>                &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(csv|tsv)$/</span>,<br>                    <span class="hljs-attr">use</span>: <span class="hljs-string">&#x27;csv-loader&#x27;</span>,<br>                &#125;,<br>                &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.xml$/</span>,<br>                    <span class="hljs-attr">use</span>: <span class="hljs-string">&#x27;xml-loader&#x27;</span>,<br>                &#125;,<br>                <br>                &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.toml$/</span>,<br>                    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;json&#x27;</span>,<br>                    <span class="hljs-attr">parser</span>: &#123;<br>                        <span class="hljs-attr">parse</span>: toml.<span class="hljs-property">parse</span><br>                    &#125;<br>                &#125;,<br>                &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.yaml$/</span>,<br>                    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;json&#x27;</span>,<br>                    <span class="hljs-attr">parser</span>: &#123;<br>                        <span class="hljs-attr">parse</span>: yaml.<span class="hljs-property">parse</span><br>                    &#125;<br>                &#125;,<br>                &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.json5$/</span>,<br>                    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;json&#x27;</span>,<br>                    <span class="hljs-attr">parser</span>: &#123;<br>                        <span class="hljs-attr">parse</span>: json5.<span class="hljs-property">parse</span><br>                    &#125;<br>                &#125;,<br>                &#123;<br>                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>                    <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,<br>                    <span class="hljs-attr">use</span>:&#123;<br>                        <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;babel-loader&#x27;</span>,<br>                        <span class="hljs-attr">options</span>: &#123;<br>                            <span class="hljs-attr">presets</span>: [<span class="hljs-string">&#x27;@babel/preset-env&#x27;</span>],<br>                            <span class="hljs-attr">plugins</span>: [<br>                                [<br>                                    <span class="hljs-string">&#x27;@babel/plugin-transform-runtime&#x27;</span>,<br>                                ]<br>                            ]<br>                        &#125;<br>                    &#125;<br>                &#125;<br>                <br>            ] <br>        &#125;,<br>    <br>        <span class="hljs-attr">optimization</span>: &#123;<br>            <span class="hljs-comment">// dev环境不需要压缩</span><br>            <span class="hljs-comment">// minimizer: [</span><br>            <span class="hljs-comment">//     new CssMinimizerPlugin(),</span><br>            <span class="hljs-comment">//     new TerserPlugin()</span><br>            <span class="hljs-comment">// ],</span><br>            <span class="hljs-attr">splitChunks</span>: &#123;<br>                <span class="hljs-attr">cacheGroups</span>: &#123;<br>                    <span class="hljs-attr">vendor</span>: &#123;<br>                        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,<br>                        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;vendors&#x27;</span>,<br>                        <span class="hljs-attr">chunks</span>: <span class="hljs-string">&#x27;all&#x27;</span><br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">npx webpack --config ./config/webpack.config.dev.js<br>npx webpack -c ./config/webpack.config.dev.js //简写<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205242241759.png" srcset="/img/loading.gif" lazyload alt="image-20220524224101667"></p>
<p>将output属性修改下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">output</span>: &#123;<br>            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;scripts/[name].js&#x27;</span>, <span class="hljs-comment">//删掉[contentHash]缓存文件名</span><br>            <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;../dist&#x27;</span>), <span class="hljs-comment">// &#x27;./dist&#x27; =&gt; &#x27;../dist&#x27;</span><br>            <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&#x27;images/[name][hash:8][ext]&#x27;</span>,<br>            <span class="hljs-comment">// publicPath: &#x27;http://localhost:8080/&#x27; //dev环境 没必要</span><br>        &#125;,<br></code></pre></td></tr></table></figure>

<p>就达到替换了</p>
<p>配置下生产配置webpack.config.prod.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;css-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;terser-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> toml = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;toml&quot;</span>);<br><span class="hljs-keyword">const</span> yaml = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;yaml&quot;</span>);<br><span class="hljs-keyword">const</span> json5 = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;json5&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">index</span>: <span class="hljs-string">&quot;./src/index.js&quot;</span>,<br>    <span class="hljs-attr">another</span>: <span class="hljs-string">&quot;./src/another-module.js&quot;</span>,<br>  &#125;,<br><br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;scripts/[name].[contenthash].js&quot;</span>,<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>), <span class="hljs-comment">// ./dist =&gt; ../dist</span><br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&quot;images/[name][hash:8][ext]&quot;</span>,<br>    <span class="hljs-attr">publicPath</span>: <span class="hljs-string">&quot;http://localhost:8080/&quot;</span>,<br>  &#125;,<br>  <span class="hljs-attr">mode</span>:  <span class="hljs-string">&quot;production&quot;</span>, <span class="hljs-comment">// prod =&gt; production</span><br><br>  <span class="hljs-comment">// devtool: &quot;inline-source-map&quot;, // 生成环境不需要调试</span><br>  <br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">template</span>: <span class="hljs-string">&quot;./index.html&quot;</span>,<br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;app.html&quot;</span>,<br>      <span class="hljs-attr">inject</span>: <span class="hljs-string">&quot;body&quot;</span>,<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;styles/[contenthash].css&quot;</span>,<br>    &#125;),<br>  ],<br>  <span class="hljs-comment">// prod 不需要devServer </span><br><span class="hljs-comment">//   devServer: &#123;</span><br><span class="hljs-comment">//     static: &quot;./dist&quot;,</span><br><span class="hljs-comment">//   &#125;,</span><br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.png$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>        <span class="hljs-attr">generator</span>: &#123;<br>          <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;images/test.png&quot;</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.svg$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/inline&quot;</span>,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.txt$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/source&quot;</span>,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.jpg$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset&quot;</span>,<br>        <span class="hljs-attr">parser</span>: &#123;<br>          <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>            <span class="hljs-attr">maxSize</span>: <span class="hljs-number">2</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>,<br>          &#125;,<br>        &#125;,<br>      &#125;,<br><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(css|less)$/</span>,<br>        <span class="hljs-attr">use</span>: [<span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>, <span class="hljs-string">&quot;css-loader&quot;</span>, <span class="hljs-string">&quot;less-loader&quot;</span>],<br>      &#125;,<br><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(woff|woff2|eot|ttf|otf)$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>      &#125;,<br><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(csv|tsv)$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-string">&quot;csv-loader&quot;</span>,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.xml$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-string">&quot;xml-loader&quot;</span>,<br>      &#125;,<br><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.toml$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;json&quot;</span>,<br>        <span class="hljs-attr">parser</span>: &#123;<br>          <span class="hljs-attr">parse</span>: toml.<span class="hljs-property">parse</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.yaml$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;json&quot;</span>,<br>        <span class="hljs-attr">parser</span>: &#123;<br>          <span class="hljs-attr">parse</span>: yaml.<span class="hljs-property">parse</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.json5$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;json&quot;</span>,<br>        <span class="hljs-attr">parser</span>: &#123;<br>          <span class="hljs-attr">parse</span>: json5.<span class="hljs-property">parse</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>        <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,<br>        <span class="hljs-attr">use</span>: &#123;<br>          <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">presets</span>: [<span class="hljs-string">&quot;@babel/preset-env&quot;</span>],<br>            <span class="hljs-attr">plugins</span>: [[<span class="hljs-string">&quot;@babel/plugin-transform-runtime&quot;</span>]],<br>          &#125;,<br>        &#125;,<br>      &#125;,<br>    ],<br>  &#125;,<br><br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">minimizer</span>: [<span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserPlugin</span>()],<br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">cacheGroups</span>: &#123;<br>        <span class="hljs-attr">vendor</span>: &#123;<br>          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;vendors&quot;</span>,<br>          <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>,<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>  &#125;,<br>&#125;;<br><br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npx webpack -c ./config/webpack.config.prod.js<br></code></pre></td></tr></table></figure>

<p>打包后的文件，代码压缩达到</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npx webpack -c 目标配置文件<br></code></pre></td></tr></table></figure>

<p><strong>通过上面2个文件达到了配置js文件的分离</strong></p>
<p>当然我们也可以使用webpack的开发服务器指定相应的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">npx webpack server -c 目标配置文件<br>// 相当于 npx webpack-dev-server<br></code></pre></td></tr></table></figure>



<h2 id="npm脚本"><a href="#npm脚本" class="headerlink" title="npm脚本"></a>npm脚本</h2><p>在子目录中创建个package.json</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205250938820.png" srcset="/img/loading.gif" lazyload></p>
<p>发现每次使用的还是最外层的node_modules的东西，且还要下载安装些依赖。不如要它们copy一份过来</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205250942779.png" srcset="/img/loading.gif" lazyload alt="image-20220525094247652"></p>
<p>再将package.json里面的scripts修改</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>   <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;webpack server -c ./config/webpack.config.dev.js&quot;</span><span class="hljs-punctuation">,</span><br>   <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;webpack -c ./config/webpack.config.prod.js&quot;</span><br> <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br></code></pre></td></tr></table></figure>

<p>为何不需要npx呢，原因是我们在package.json中写脚本，它会自动去往node_modules中找相应的脚本来执行。这样走的就是当前目录的东西了。不用下载依赖</p>
<h2 id="提取公共配置"><a href="#提取公共配置" class="headerlink" title="提取公共配置"></a>提取公共配置</h2><p>在config文件夹内新建个webpack.config.common.js，将公共配置提取到这个js文件内</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> toml = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;toml&quot;</span>);<br><span class="hljs-keyword">const</span> yaml = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;yaml&quot;</span>);<br><span class="hljs-keyword">const</span> json5 = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;json5&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">index</span>: <span class="hljs-string">&quot;./src/index.js&quot;</span>,<br>    <span class="hljs-attr">another</span>: <span class="hljs-string">&quot;./src/another-module.js&quot;</span>,<br>  &#125;,<br><br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-comment">// filename: &quot;scripts/[name].[contenthash].js&quot;, </span><br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>),<br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&quot;images/[name][hash:8][ext]&quot;</span>,<br>    <span class="hljs-comment">// publicPath: &quot;http://localhost:8080/&quot;,</span><br>  &#125;,<br><span class="hljs-comment">//   mode: env.production ? &quot;production&quot; : &quot;development&quot;,</span><br><span class="hljs-comment">//   devtool: &quot;inline-source-map&quot;,</span><br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">template</span>: <span class="hljs-string">&quot;./index.html&quot;</span>,<br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;app.html&quot;</span>,<br>      <span class="hljs-attr">inject</span>: <span class="hljs-string">&quot;body&quot;</span>,<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;styles/[contenthash].css&quot;</span>,<br>    &#125;),<br>  ],<br><span class="hljs-comment">//   devServer: &#123;</span><br><span class="hljs-comment">//     static: &quot;./dist&quot;,</span><br><span class="hljs-comment">//   &#125;,</span><br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.png$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>        <span class="hljs-attr">generator</span>: &#123;<br>          <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;images/test.png&quot;</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.svg$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/inline&quot;</span>,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.txt$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/source&quot;</span>,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.jpg$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset&quot;</span>,<br>        <span class="hljs-attr">parser</span>: &#123;<br>          <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>            <span class="hljs-attr">maxSize</span>: <span class="hljs-number">2</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>,<br>          &#125;,<br>        &#125;,<br>      &#125;,<br><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(css|less)$/</span>,<br>        <span class="hljs-attr">use</span>: [<span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>, <span class="hljs-string">&quot;css-loader&quot;</span>, <span class="hljs-string">&quot;less-loader&quot;</span>],<br>      &#125;,<br><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(woff|woff2|eot|ttf|otf)$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>      &#125;,<br><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(csv|tsv)$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-string">&quot;csv-loader&quot;</span>,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.xml$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-string">&quot;xml-loader&quot;</span>,<br>      &#125;,<br><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.toml$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;json&quot;</span>,<br>        <span class="hljs-attr">parser</span>: &#123;<br>          <span class="hljs-attr">parse</span>: toml.<span class="hljs-property">parse</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.yaml$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;json&quot;</span>,<br>        <span class="hljs-attr">parser</span>: &#123;<br>          <span class="hljs-attr">parse</span>: yaml.<span class="hljs-property">parse</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.json5$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;json&quot;</span>,<br>        <span class="hljs-attr">parser</span>: &#123;<br>          <span class="hljs-attr">parse</span>: json5.<span class="hljs-property">parse</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>        <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,<br>        <span class="hljs-attr">use</span>: &#123;<br>          <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">presets</span>: [<span class="hljs-string">&quot;@babel/preset-env&quot;</span>],<br>            <span class="hljs-attr">plugins</span>: [[<span class="hljs-string">&quot;@babel/plugin-transform-runtime&quot;</span>]],<br>          &#125;,<br>        &#125;,<br>      &#125;,<br>    ],<br>  &#125;,<br><br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-comment">// minimizer: [new CssMinimizerPlugin(), new TerserPlugin()],</span><br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">cacheGroups</span>: &#123;<br>        <span class="hljs-attr">vendor</span>: &#123;<br>          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;vendors&quot;</span>,<br>          <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>,<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>  &#125;,<br>&#125;;<br><br></code></pre></td></tr></table></figure>

<p>修改webpack.config.dev.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;scripts/[name].js&quot;</span>, <span class="hljs-comment">//删掉[contentHash]缓存文件名</span><br>  &#125;,<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;development&quot;</span>, <span class="hljs-comment">//dev 肯定使用这个</span><br><br>  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;inline-source-map&quot;</span>, <span class="hljs-comment">//需要调试代码，这个是需要的</span><br><br>  <span class="hljs-attr">devServer</span>: &#123;<br>    <span class="hljs-comment">// dev环境肯定需要这个</span><br>    <span class="hljs-attr">static</span>: <span class="hljs-string">&quot;./dist&quot;</span>,<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure>

<p>修改webpack.config.prod.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;css-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;terser-webpack-plugin&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;scripts/[name].[contenthash].js&quot;</span>,<br>    <span class="hljs-attr">publicPath</span>: <span class="hljs-string">&quot;http://localhost:8080/&quot;</span>,<br>  &#125;,<br>  <span class="hljs-attr">mode</span>:  <span class="hljs-string">&quot;production&quot;</span>, <span class="hljs-comment">// prod =&gt; production</span><br><br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">minimizer</span>: [<span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserPlugin</span>()],<br>  &#125;,<br><br>  <span class="hljs-attr">performance</span>: &#123;<br>      <span class="hljs-attr">hints</span>: <span class="hljs-literal">false</span><br>  &#125;<br>&#125;;<br><br></code></pre></td></tr></table></figure>

<p>使用webpack-merge 将通用配置和不同环境的配置合并</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install webpack-merge -D<br></code></pre></td></tr></table></figure>

<p>在config文件夹下创建webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; merge &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;webpack-merge&quot;</span>);<br><br><span class="hljs-keyword">const</span> commonConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./webpack.config.common&quot;</span>);<br><span class="hljs-keyword">const</span> productionConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./webpack.config.prod&quot;</span>);<br><span class="hljs-keyword">const</span> developmentConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./webpack.config.dev&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">(<span class="hljs-params">env</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">switch</span> (<span class="hljs-literal">true</span>) &#123;<br>    <span class="hljs-keyword">case</span> env.<span class="hljs-property">development</span>:<br>      <span class="hljs-keyword">return</span> <span class="hljs-title function_">merge</span>(commonConfig, developmentConfig);<br>    <span class="hljs-keyword">case</span> env.<span class="hljs-property">production</span>:<br>      <span class="hljs-keyword">return</span> <span class="hljs-title function_">merge</span>(commonConfig, productionConfig);<br>    <span class="hljs-attr">default</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27; No mating&#x27;</span>)<br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>

<p>再次修改下package.json的scripts脚本属性</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;webpack server -c ./config/webpack.config.js --env development&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;webpack -c ./config/webpack.config.js --env production&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br></code></pre></td></tr></table></figure>

<p>然后运行<code>npm run start</code>或者<code>npm run build</code></p>
<p>达到了环境拆分、配置不同文件</p>
<h2 id="小结-4"><a href="#小结-4" class="headerlink" title="小结"></a>小结</h2><ul>
<li>一开始我们使用配置publicPath来配置公共路径，</li>
<li>接着在命令行中可以携带<code>--env xxxx</code> 可以传到webpack.config.js中去，</li>
<li>拆分dev和prod环境的配置，分为2个不同的文件，每次执行的时候选择不同的文件去执行</li>
<li>使用package.json的scripts脚本可以配置我们每次运行的命令</li>
<li>将dev和prod的2个文件的共同部分抽离出来，再使用webpack-merge这个第三方依赖将通用配置和不同环境特有的配置合并后再运行webpack进行处理</li>
</ul>
<h1 id="高级应用"><a href="#高级应用" class="headerlink" title="高级应用"></a>高级应用</h1><h1 id="提高开发效率与完善团队开发规范"><a href="#提高开发效率与完善团队开发规范" class="headerlink" title="提高开发效率与完善团队开发规范"></a>提高开发效率与完善团队开发规范</h1><h2 id="source-map"><a href="#source-map" class="headerlink" title="source-map"></a>source-map</h2><blockquote>
<p>何为source-map，是我们打包后的bundle.js在浏览器若发生报错，我们可以<strong>快速定位到开发时的js文件的位置</strong>。</p>
</blockquote>
<p> devtool属性的7个模式</p>
<table>
<thead>
<tr>
<th>模式</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>eval</td>
<td>每个module会封装到 eval 里包裹起来执行，并且会在末尾追加注释 &#x2F;&#x2F;@ sourceURL.</td>
</tr>
<tr>
<td>source-map</td>
<td>生成一个SourceMap文件</td>
</tr>
<tr>
<td>hidden-source-map</td>
<td>和 source-map 一样，但不会在 bundle 末尾追加注释.</td>
</tr>
<tr>
<td>inline-source-map</td>
<td>生成一个 DataUrl 形式的 SourceMap 文件．</td>
</tr>
<tr>
<td>eval-source-map</td>
<td>每个module会通过eval()来执行，并且生成一个DataUr!形式的SourceMap.</td>
</tr>
<tr>
<td>cheap-source-map</td>
<td>生成一个没有列信息(column-mappings）的SourceMaps文件，不包含loader的sourcemap（譬如 babel 的 sourcemap)</td>
</tr>
<tr>
<td>cheap-module-source-map</td>
<td>生成一个没有列信息 (column-mappings) 的SourceMaps文件，同时 loader的sourcemap 也被简化为只包含对应行的。</td>
</tr>
</tbody></table>
<p>要注意的是，生产环境我们一般不会开启sourcemap功能，主要有两点原因：</p>
<ol>
<li>通过bundle和sourcemap文件，可以反编译出源码一一一一也就是说，线上产物有soucemap文件的话，就意味着有暴漏源码的风险。</li>
<li>我们可以观察到，sourcemap文件的体积相对比较巨大,这跟我们生产环境的追求不同(生产环境追求更小更轻量的bundle)。</li>
</ol>
<h4 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h4><p>webpack的devtool的默认模式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    <br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./app.js&#x27;</span>,<br><br>    <span class="hljs-comment">// devtool: false,</span><br><br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>()<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>

<p>不开启devtool默认走eval</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251135864.png" srcset="/img/loading.gif" lazyload alt="image-20220525113520766"></p>
<p>发现打包好的文件，走的是eval，启动devserver</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251136951.png" srcset="/img/loading.gif" lazyload alt="image-20220525113620849"></p>
<p>发现文件定位在了 <code>app.js</code>可以帮助开发人员快速定位代码的位置</p>
<p>当吧devtool设置为false</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    <br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./app.js&#x27;</span>,<br><br>    <span class="hljs-attr">devtool</span>: <span class="hljs-literal">false</span>,<br><br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>()<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251137109.png" srcset="/img/loading.gif" lazyload alt="image-20220525113742009"></p>
<p>发现就直接讲app.js的代码挪到了打包好的main.js里面了，开启devserver</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251139553.png" srcset="/img/loading.gif" lazyload alt="image-20220525113902451"></p>
<p>这样就没办法定位开发时的源码位置在哪了。</p>
<h4 id="source-map-1"><a href="#source-map-1" class="headerlink" title="source-map"></a>source-map</h4><p>将devtool设置为<code>source-map</code></p>
<p>运行<code>npx webpack</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251143190.png" srcset="/img/loading.gif" lazyload alt="image-20220525114334095"></p>
<p>发现还是跟关闭devtool的时候一样，只是代码多了个注释，打包后多了个map文件</p>
<p>运行<code>npx webpack server</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251145295.png" srcset="/img/loading.gif" lazyload alt="image-20220525114526233"></p>
<p>发现我们还是可以定位代码的源头</p>
<h4 id="hidden-source-map"><a href="#hidden-source-map" class="headerlink" title="hidden-source-map"></a>hidden-source-map</h4><p>将devtool设置为hidden-source-map</p>
<p> 与source-map作类比，就是打包后的main.js文件中少了个map注释</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251147631.png" srcset="/img/loading.gif" lazyload alt="image-20220525114706547"></p>
<p>运行<code>npx webpack server</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251148435.png" srcset="/img/loading.gif" lazyload alt="image-20220525114843363"></p>
<p>发现已经不可以定位业务代码的位置</p>
<p>说明使用hidden-source-map模式虽然也是会生产map文件，但是已经不会和我们的main.js作关联了。</p>
<h4 id="inline-source-map"><a href="#inline-source-map" class="headerlink" title="inline-source-map"></a>inline-source-map</h4><p>devtool设置为inline-source-map</p>
<p>运行<code>npx webpack</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251153162.png" srcset="/img/loading.gif" lazyload alt="image-20220525115346064"></p>
<p>运行<code>npx webpack server</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251154806.png" srcset="/img/loading.gif" lazyload alt="image-20220525115424696"></p>
<p>发现效果和source-map一样，可以定位源代码的位置。只是区别在于</p>
<ul>
<li><p>少了source-map模式下会打包多个map文件</p>
</li>
<li><p>注释的东西不一样</p>
</li>
</ul>
<h4 id="eval-source-map"><a href="#eval-source-map" class="headerlink" title="eval-source-map"></a>eval-source-map</h4><p>devtool设置为eval-source-map</p>
<p>运行<code>npx webpack</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251157540.png" srcset="/img/loading.gif" lazyload alt="image-20220525115736429"></p>
<p>运行<code>npx webpack server</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251158142.png" srcset="/img/loading.gif" lazyload alt="image-20220525115808024"></p>
<p>发现效果和inline-source-map一样，可以定位源代码的位置。</p>
<ul>
<li><p>一样少了source-map模式下会打包多个map文件</p>
</li>
<li><p>注释的东西不一样</p>
</li>
<li><p>eval后面的注释，应该是用Base64的形式生成的</p>
</li>
</ul>
<h4 id="cheap-source-map"><a href="#cheap-source-map" class="headerlink" title="cheap-source-map"></a>cheap-source-map</h4><p>会生成一个没有列信息的sourcemap</p>
<p>修改为cheap-source-map，运行<code>npx webpack</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251417793.png" srcset="/img/loading.gif" lazyload alt="image-20220525141701680"></p>
<p>这个mappings是代码映射，里面的内容是代码的行数描述，没有列数。</p>
<p>若改为source-map，运行<code>npx webpack</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251418245.png" srcset="/img/loading.gif" lazyload alt="image-20220525141832130"></p>
<p>多了这个是列数，现在代码只有一行，但实际情况，代码有很多的，而且一般开发的时候，定到行数就行，没必要让这个文件那么大。</p>
<p>这个同样是可以定位到源代码的。</p>
<h4 id="cheap-module-source-map"><a href="#cheap-module-source-map" class="headerlink" title="cheap-module-source-map"></a>cheap-module-source-map</h4><p>和上面的效果一样，但是这个模式还会加载一些第三方库。上面的cheap-source-map却不会。</p>
<p>在当前项目中安装babel</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install babel-loader @babel/core @babel/preset-env -D<br></code></pre></td></tr></table></figure>

<p>使用ES6类写法，让babel可以进行转化</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span> = <span class="hljs-string">&#x27;hello webpack&#x27;</span><br>    &#125;<br>    <br>    <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>()<br><br>a.<span class="hljs-title function_">sayHello</span>()<br></code></pre></td></tr></table></figure>

<p>运行<code>npx webpack</code> </p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251431236.png" srcset="/img/loading.gif" lazyload alt="image-20220525143145094"></p>
<p>运行<code>npx webpack server</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251430130.png" srcset="/img/loading.gif" lazyload alt="image-20220525143015003"></p>
<p>将devtool改为上一个cheap-source-map</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251432226.png" srcset="/img/loading.gif" lazyload alt="image-20220525143254121"></p>
<p>没法定位到源代码了。原因是因为使用cheap-source-map这个不包含loader到mapsource</p>
<p><strong>所以在开发环境里，推荐大家使用cheap-module-source-map</strong>不但可以帮助我们生成map文件，而且不记录列数，同时对第三方库混入进来也不会影响到source-map的生成后的代码识别问题。</p>
<h2 id="devServer"><a href="#devServer" class="headerlink" title="devServer"></a>devServer</h2><h3 id="开启压缩"><a href="#开启压缩" class="headerlink" title="开启压缩"></a>开启压缩</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./app.js&#x27;</span>,<br>    <span class="hljs-attr">devServer</span>: &#123;<br>        <span class="hljs-attr">static</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>),<br>        <span class="hljs-attr">compress</span>: <span class="hljs-literal">true</span>,  <span class="hljs-comment">//配置压缩</span><br>    &#125;,<br><br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>()<br>    ],<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251456765.png" srcset="/img/loading.gif" lazyload alt="image-20220525145600643"></p>
<p>gzip可以减少网络带宽</p>
<h3 id="修改端口号"><a href="#修改端口号" class="headerlink" title="修改端口号"></a>修改端口号</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = &#123;<br>    mode: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    entry: <span class="hljs-string">&#x27;./app.js&#x27;</span>,<br>    devServer: &#123;<br>        <span class="hljs-keyword">static</span>: path.resolve(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>),<br>        compress: <span class="hljs-literal">true</span>,  <span class="hljs-comment">//配置压缩</span><br>        port: <span class="hljs-number">3000</span>, <span class="hljs-comment">//这个时候的本地开发服务器就是 localhost:3000</span><br>    &#125;,<br><br>    plugins: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>()<br>    ],<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="添加响应头"><a href="#添加响应头" class="headerlink" title="添加响应头"></a>添加响应头</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">devServer</span>: &#123;<br>        <span class="hljs-attr">static</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>),<br>        <span class="hljs-attr">compress</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">port</span>: <span class="hljs-number">3000</span>, <span class="hljs-comment">//这个时候的本地开发服务器就是 localhost:3000</span><br>        <span class="hljs-attr">headers</span>: &#123;<br>            <span class="hljs-string">&#x27;X-Access-Token&#x27;</span>: <span class="hljs-string">&#x27;abc123&#x27;</span><br>        &#125;<br>    &#125;,<br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251500854.png" srcset="/img/loading.gif" lazyload alt="image-20220525150053783"></p>
<h3 id="开启代理"><a href="#开启代理" class="headerlink" title="开启代理"></a>开启代理</h3><p>网页访问某些接口，可能会有跨域问题，如果不做代理处理，那么开发服务器访问不了接口。</p>
<p>模拟个服务器，使用node去写个简单接口服务 创建个server.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;http&#x27;</span>)<br><br><span class="hljs-keyword">const</span> app = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span>(req.<span class="hljs-property">url</span> === <span class="hljs-string">&#x27;/api/hello&#x27;</span>) &#123;<br>        res.<span class="hljs-title function_">end</span>(<span class="hljs-string">&#x27;hello node&#x27;</span>)<br>    &#125;<br>&#125;)<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">9000</span>, <span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;localhost:9000&#x27;</span>);<br>&#125;)<br></code></pre></td></tr></table></figure>

<p>运行<code>node server.js</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251507862.png" srcset="/img/loading.gif" lazyload alt="image-20220525150725783"></p>
<p>开启个端口为9000的服务</p>
<p>修改app.js 去请求上面启动的服务的接口</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://localhost:9000/api/hello&#x27;</span>)<br>    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">resp</span> =&gt;</span> resp.<span class="hljs-title function_">text</span>())<br>    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);<br>    &#125;)<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251510988.png" srcset="/img/loading.gif" lazyload alt="image-20220525151057883"></p>
<p>发生了跨域问题</p>
<p>将上面代码改下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/api/hello&#x27;</span>)<br>    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">resp</span> =&gt;</span> resp.<span class="hljs-title function_">text</span>())<br>    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);<br>    &#125;)<br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">devServer</span>: &#123;<br>        <span class="hljs-attr">static</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>),<br>        <span class="hljs-attr">compress</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">port</span>: <span class="hljs-number">3000</span>, <span class="hljs-comment">//这个时候的本地开发服务器就是 localhost:3000</span><br>        <span class="hljs-attr">headers</span>: &#123;<br>            <span class="hljs-string">&#x27;X-Access-Token&#x27;</span>: <span class="hljs-string">&#x27;abc123&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">proxy</span>: &#123;<br>            <span class="hljs-string">&#x27;/api&#x27;</span>: <span class="hljs-string">&#x27;http://localhost:9000&#x27;</span><br>        &#125;<br>    &#125;,<br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251513762.png" srcset="/img/loading.gif" lazyload alt="image-20220525151355648"></p>
<h3 id="https"><a href="#https" class="headerlink" title="https"></a>https</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">devServer:</span> &#123;<br>        <span class="hljs-attr">static:</span> <span class="hljs-string">path.resolve(__dirname</span>, <span class="hljs-string">&#x27;./dist&#x27;</span><span class="hljs-string">)</span>,<br>        <span class="hljs-attr">compress:</span> <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">port:</span> <span class="hljs-number">3000</span>, <span class="hljs-string">//这个时候的本地开发服务器就是</span> <span class="hljs-string">localhost:3000</span><br>        <span class="hljs-attr">headers:</span> &#123;<br>            <span class="hljs-attr">&#x27;X-Access-Token&#x27;:</span> <span class="hljs-string">&#x27;abc123&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">proxy:</span> &#123;<br>            <span class="hljs-string">&#x27;/api&#x27;</span><span class="hljs-string">:</span> <span class="hljs-string">&#x27;http://localhost:9000&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">https:</span> <span class="hljs-literal">true</span> <br>    &#125;<span class="hljs-string">,</span><br></code></pre></td></tr></table></figure>

<p>重新运行<code>npx webpack server</code></p>
<p>此时http:&#x2F;&#x2F; &#x3D;&gt; https:&#x2F;&#x2F; </p>
<p>但是，由于默认配置使用的是自签名证书，所以浏览器会告诉你是不安全的，但我们依然可以访问它，当然我们在配置中，配置自己的证书就不会出现这个问题了。</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251519848.png" srcset="/img/loading.gif" lazyload alt="image-20220525151943729"></p>
<h3 id="http2"><a href="#http2" class="headerlink" title="http2"></a>http2</h3><p>和http是一样的操作。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">devServer</span>: &#123;<br>        <span class="hljs-attr">http2</span>: <span class="hljs-literal">true</span> <br>    &#125;,<br></code></pre></td></tr></table></figure>



<h3 id="historyApiFallback"><a href="#historyApiFallback" class="headerlink" title="historyApiFallback"></a>historyApiFallback</h3><p>When using the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/History">HTML5 History API</a>, the <code>index.html</code> page will likely have to be served in place of any <code>404</code> responses. Enable <code>devServer.historyApiFallback</code> by setting it to <code>true</code></p>
<h3 id="host"><a href="#host" class="headerlink" title="host"></a>host</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">devServer</span>: &#123;<br>  <span class="hljs-attr">host</span>: <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,<br>&#125;<br></code></pre></td></tr></table></figure>

<p>配置后，其他人的电脑在同一个局域网就可以访问到当前这个开发服务器了。</p>
<h2 id="模块热替换与热加载"><a href="#模块热替换与热加载" class="headerlink" title="模块热替换与热加载"></a>模块热替换与热加载</h2><ul>
<li><p>模块热替换(HMR - hot module replacement)功能会在应用程序运行过程中，替换、添加或删除 模块，而无需重新加载整个页面。</p>
</li>
<li><p>热加载(文件更新时，自动刷新我们的服务和页面)新版的webpack-dev-server默认已经开启了热加载的功能。它对应的参数是devServer.liveReload，默认为true。注意，如果想要关掉它，要将liveReload设置为false的同时，也要关掉hot</p>
</li>
</ul>
<blockquote>
<p>注意点：配置的loader,会自动进行热替换，若没有配置相应loader的话</p>
<p>如引入个js文件，使用这个js时，去修改js，会导致这个资源文件的变化 </p>
<p><a target="_blank" rel="noopener" href="https://webpack.js.org/api/hot-module-replacement/">https://webpack.js.org/api/hot-module-replacement/</a></p>
</blockquote>
<h2 id="eslint"><a href="#eslint" class="headerlink" title="eslint"></a>eslint</h2><p>安装依赖</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i eslint -D<br></code></pre></td></tr></table></figure>

<p>使用eslint</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npx eslint --init <br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251637866.png" srcset="/img/loading.gif" lazyload alt="image-20220525163755722"></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251638111.png" srcset="/img/loading.gif" lazyload alt="image-20220525163820980"></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251638135.png" srcset="/img/loading.gif" lazyload alt="image-20220525163828010"></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251638233.png" srcset="/img/loading.gif" lazyload alt="image-20220525163840087"></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251640876.png" srcset="/img/loading.gif" lazyload alt="image-20220525164038739"></p>
<p>以JSON的格式生成eslint的配置文件，（可以选JavaScript、YAML这2个格式）</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;env&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;browser&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;es2021&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;extends&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-string">&quot;airbnb-base&quot;</span><br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;parserOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;ecmaVersion&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;latest&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;sourceType&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;module&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;rules&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure>



<p>创建个src&#x2F;app.js</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251645989.png" srcset="/img/loading.gif" lazyload alt="image-20220525164524859"></p>
<p>发现1警告、2错误</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251645513.png" srcset="/img/loading.gif" lazyload alt="image-20220525164547396"></p>
<ul>
<li>不可以使用console</li>
<li>代码末位需要换行</li>
<li>每行代码需要分号</li>
</ul>
<p>可以修改eslint的配置去掉警告or错误</p>
<p>将上图红框内的no-console配置到eslint的json配置文件<code>.eslintrc.json</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>    <span class="hljs-string">&quot;env&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;browser&quot;</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-string">&quot;es2021&quot;</span>: <span class="hljs-literal">true</span><br>    &#125;,<br>    <span class="hljs-string">&quot;extends&quot;</span>: [<br>        <span class="hljs-string">&quot;airbnb-base&quot;</span><br>    ],<br>    <span class="hljs-string">&quot;parserOptions&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;ecmaVersion&quot;</span>: <span class="hljs-string">&quot;latest&quot;</span>,<br>        <span class="hljs-string">&quot;sourceType&quot;</span>: <span class="hljs-string">&quot;module&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;rules&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;no-console&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">//加入后，就不会警告了</span><br>    &#125;,<br>    <span class="hljs-string">&quot;globals&quot;</span>: &#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>检查错误2个方式</p>
<ul>
<li><p>运行<code>npx eslint 目录</code></p>
</li>
<li><p>vscode安装eslint插件</p>
</li>
</ul>
<p>eslint与webpack配合使用</p>
<p>首先安装依赖</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install webpack webpack-cli webpack-dev-server html-webpack-plugin babel-loader eslint-webpack-plugin @babel/core  -D    <br></code></pre></td></tr></table></figure>



<p>配置webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;eslint-webpack-plugin&#x27;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/app.js&#x27;</span>,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>        <span class="hljs-attr">use</span>: [<span class="hljs-string">&#x27;babel-loader&#x27;</span>],<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintPlugin</span>()],<br>&#125;;<br><br></code></pre></td></tr></table></figure>

<p>当项目中js与eslint的配置不相符时，webpack就会直接报错</p>
<h2 id="git-hooks与husky"><a href="#git-hooks与husky" class="headerlink" title="git-hooks与husky"></a>git-hooks与husky</h2><h4 id="实现提交代码前检查代码"><a href="#实现提交代码前检查代码" class="headerlink" title="实现提交代码前检查代码"></a>实现提交代码前检查代码</h4><p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251724859.png" srcset="/img/loading.gif" lazyload alt="image-20220525172458780"></p>
<p>研究下git-hooks</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251729343.png" srcset="/img/loading.gif" lazyload alt="image-20220525172938220"></p>
<p>hooks下定义git默认的hook。【hook：触发git命令前后会触发这些命令，这些命令是自动执行的，只要我们配置好，git会帮我们自动运行】</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251730985.png" srcset="/img/loading.gif" lazyload alt="image-20220525173031860"></p>
<p>需求：代码提交前检查我们当前代码有没有问题。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> pre-commit.sample<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><figcaption><span>basic</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs visual">#!/bin/sh<br>#<br># An example hook script to verify what is about to be committed.<br># Called by &quot;git commit&quot; with no arguments.  The hook should<br># exit with non-zero status after issuing an appropriate message if<br># it wants to stop the commit.<br>#<br># To enable this hook, rename this file to &quot;pre-commit&quot;.<br><br>if git rev-parse --verify HEAD &gt;/dev/null 2&gt;&amp;1<br>then<br>        against=HEAD<br>else<br>        # Initial commit: diff against an empty tree object<br>        against=$(git hash-object -t tree /dev/null)<br>fi<br><br># If you want to allow non-ASCII filenames set this variable to true.<br>allownonascii=$(git config --type=bool hooks.allownonascii)<br><br># Redirect output to stderr.<br>exec 1&gt;&amp;2<br><br># Cross platform projects tend to avoid non-ASCII filenames; prevent<br># them from being added to the repository. We exploit the fact that the<br># printable range starts at the space character and ends with tilde.<br>if [ &quot;$allownonascii&quot; != &quot;true&quot; ] &amp;&amp;<br>        # Note that the use of brackets around a tr range is ok here, (it&#x27;s<br>        # even required, for portability to Solaris 10&#x27;s /usr/bin/tr), since<br>        # the square bracket bytes happen to fall in the designated range.<br>        test $(git diff --cached --name-only --diff-filter=A -z $against |<br>          LC_ALL=C tr -d &#x27;[ -~]\0&#x27; | wc -c) != 0<br>then<br>        cat &lt;&lt;\EOF<br>Error: Attempt to add a non-ASCII file name.<br><br>This can cause problems if you want to work with people on other platforms.<br><br>To be portable it is advisable to rename the file.<br><br>If you know what you are doing you can disable this check using:<br><br>  git config hooks.allownonascii true<br>EOF<br>        exit 1<br>fi<br><br># If there are whitespace errors, print the offending file names and fail.<br>exec git diff-index --check --cached $against --<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">touch</span> pre-commit<br>vim pre-commit<br></code></pre></td></tr></table></figure>

<p>写个输出语句</p>
<figure class="highlight plaintext"><figcaption><span>basic</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs visual">echo pre-commit<br></code></pre></td></tr></table></figure>

<p>在当前文件随便修改下，然后再尝试提交。</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251737649.png" srcset="/img/loading.gif" lazyload alt="image-20220525173741569"></p>
<p>刚才那个<code>pre-commit</code>文件没有权限，提升下权限就行了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> +x ./pre-commit<br></code></pre></td></tr></table></figure>

<p>再次执行代码的提交</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251741433.png" srcset="/img/loading.gif" lazyload alt="image-20220525174115368"></p>
<p>发现输出了<code>pre-commit</code></p>
<p>这次我们修改下pre-commit的内容</p>
<p><code>vim .git/hooks/pre-commit</code></p>
<figure class="highlight plaintext"><figcaption><span>basic</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs visual">npx eslint ./src<br></code></pre></td></tr></table></figure>

<p>改成我们在终端写的命令</p>
<p>然后我们将src&#x2F;app.js修改为eslint不通过的版本，再接着试下提交代码</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205251745492.png" srcset="/img/loading.gif" lazyload alt="image-20220525174557419"></p>
<p>发现提交不了，原因是eslint不通过，</p>
<p>所以在团队开发时，定义一套eslint规范，当提交代码前，验证通不通过规范，保证团队代码的规范与整洁</p>
<h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p>每次都要开发人员自己去修改.git&#x2F;hooks&#x2F;xxxx文件太麻烦了</p>
<p>创建我们定义的文件</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252036845.png" srcset="/img/loading.gif" lazyload alt="image-20220525203524920"></p>
<p>配置git的hooksPath为当前目录的.myGitHooks</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252048587.png" srcset="/img/loading.gif" lazyload alt="image-20220525204823490"></p>
<p>同样给我们创建的pre-commit提升权限，修改我们的app.js为不可以通过eslint的版本</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252047617.png" srcset="/img/loading.gif" lazyload></p>
<p>上面的操作都是手工去操作的，太麻烦了，可以使用husky工具帮我们完成</p>
<h4 id="husky"><a href="#husky" class="headerlink" title="husky"></a>husky</h4><p>先把上面自己自定义的hooksPath给删掉，<code>vim .git/config</code>编辑下删除</p>
<p>安装husky依赖    <a target="_blank" rel="noopener" href="https://typicode.github.io/husky/#/?id=manual">husky官网教程</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i husky -D<br><br>npx husky install<br><br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252056115.png" srcset="/img/loading.gif" lazyload alt="image-20220525205650025"></p>
<p>在package.json的scripts内创建husky install</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252058360.png" srcset="/img/loading.gif" lazyload alt="image-20220525205846282"></p>
<p>在.husky文件夹下创建我们的hook</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252101845.png" srcset="/img/loading.gif" lazyload alt="image-20220525210102772"></p>
<p>将app.js 修改为eslint通不过的版本</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252105435.png" srcset="/img/loading.gif" lazyload alt="image-20220525210558380"></p>
<h4 id="小结-5"><a href="#小结-5" class="headerlink" title="小结"></a>小结</h4><p>首先手工配置.git&#x2F;hook&#x2F;pre-commit文件做到提交前检查代码，接着优化成使用我们自己创建的文件<code>.myGitHooks/pre-commit</code>去完成提交前检查代，最后使用husky工具，帮助我们简化操作上面的操作方式。</p>
<ul>
<li>安装husky开发依赖，</li>
<li><code>package.json</code>加入<code>prepare</code>脚本，</li>
<li>添加自定义文件<code>pre-commit</code>，</li>
<li>提升权限，</li>
<li>不用我们自己去配置hooksPath的指向目录。</li>
</ul>
<h2 id="模块与依赖"><a href="#模块与依赖" class="headerlink" title="模块与依赖"></a>模块与依赖</h2><h3 id="webpack模块"><a href="#webpack模块" class="headerlink" title="webpack模块"></a>webpack模块</h3><p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252116129.png" srcset="/img/loading.gif" lazyload alt="image-20220525211627050"></p>
<p>这些都认为是webpack可以应用的模块（ECMAScript模块、CommonJS模块、AMD模块、Assets模块）</p>
<p>通过loader我们发现webpack可以处理多种语言和预处理的语法来变成模块，并且将这些相关依赖引入bundle中</p>
<p>原生支持的模块、和loader处理的模块 都认为是webpack的模块</p>
<h4 id="webpack模块解析简易原理"><a href="#webpack模块解析简易原理" class="headerlink" title="webpack模块解析简易原理"></a>webpack模块解析简易原理</h4><p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252123105.png" srcset="/img/loading.gif" lazyload alt="image-20220525212304024"></p>
<h2 id="外部拓展"><a href="#外部拓展" class="headerlink" title="外部拓展"></a>外部拓展</h2><p>使用webpack的externals属性将项目内一些<strong>模块名称</strong>可以作为外部拓展</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;development&quot;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./app.js&#x27;</span>,<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>()<br>    ],<br>    <span class="hljs-attr">externals</span>: &#123;<br>        <span class="hljs-attr">jquery</span>: <span class="hljs-string">&#x27;jQuery&#x27;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>创建app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> $ <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;jquery&#x27;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>($);<br></code></pre></td></tr></table></figure>

<p>因为没有引入jQuery的cdn所以页面会报错</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252152334.png" srcset="/img/loading.gif" lazyload alt="image-20220525215254243"></p>
<p>创建index.html，并且引入jQuery的cdn</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>再修改下webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>            <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;./index.html&#x27;</span><br>        &#125;)<br>    ],<br></code></pre></td></tr></table></figure>

<p>运行<code>npx webpack server</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252155581.png" srcset="/img/loading.gif" lazyload alt="image-20220525215517496"></p>
<p>成功引入了。</p>
<h3 id="问题-1"><a href="#问题-1" class="headerlink" title="问题"></a>问题</h3><p>每次都要手动去引入外部的cdn链接，太麻烦，能不能让webpack自动去引入</p>
<p>操作：</p>
<ul>
<li>删除index.html</li>
<li>删除HtmlWebpackPlugin内配置的template</li>
<li>修改externals</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252159510.png" srcset="/img/loading.gif" lazyload alt="image-20220525215918428"></p>
<p>运行<code>npx webpack server</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252201010.png" srcset="/img/loading.gif" lazyload alt="image-20220525220105927"></p>
<p>这是因为上面引入的cdn，我们没有告诉webpack它要以什么形式这拿这个cdn资源</p>
<p><strong>修改webpack.config.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">externalsType</span>: <span class="hljs-string">&#x27;script&#x27;</span>,<br>  <span class="hljs-attr">externals</span>: &#123;<br>      <span class="hljs-attr">jquery</span>: [<br>          <span class="hljs-string">&#x27;https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js&#x27;</span>,<br>          <span class="hljs-string">&#x27;$&#x27;</span><br>      ]<br>  &#125;<br></code></pre></td></tr></table></figure>

<p>再次运行<code>npx webpack server</code></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252203125.png" srcset="/img/loading.gif" lazyload alt="image-20220525220338036"></p>
<p>成功引入！</p>
<p>达到了缩小打包体积大小，降低首屏加载时间！</p>
<h2 id="依赖图分析"><a href="#依赖图分析" class="headerlink" title="依赖图分析"></a>依赖图分析</h2><p>每当一个文件依赖另一个文件时，webpack 会直接将文件视为存在依赖关系。这使得 webpack 可以获取非代码资源，如 images 或 web 字体等。并会把它们作为 依赖提供给应用程序。当 webpack 开始工作时，它会根据我们写好的配置,从 入口(entry) 开始，webpack 会递归的构建一个 依赖关系图，这个依赖图包含着应用程序中所需的每个模块，然后将所有模块打包为bundle(也就是output的配置项)。<br>单纯讲似乎很抽象，我们更期望能够可视化打包产物的依赖图，下边列示了一些bundle分析工具。</p>
<p><strong>bundle 分析(bundle analysis)</strong> 工具：</p>
<p><strong>官方分析工具</strong> 是一个不错的开始。还有一些其他社区支持的可选项：</p>
<ul>
<li>webpack-chart:webpack stats 可交互饼图。</li>
<li>webpackvisualizer：可视化并分析你的 bundle，检查哪些模块占用空间，哪些可能是重复使用的。</li>
<li>webpack-bundle-analyzer： 一个 plugin 和CLI工具，它将 bundle 内容展示为一个便捷的、交互式、可缩放的<br>树状图形式。</li>
<li>webpack bundle optimize helper：这个工具会分析你的 bundle，并提供可操作的改进措施，以减少 bundle 的<br>大小。</li>
<li>bundle-stats：生成一个 bundle 报告 (bundle 大小、资源、模块)，并比较不同构建之间的结果。</li>
</ul>
<p> 安装webpack-bundle-analyzer依赖</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i webpack-bundle-analyzer-D<br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">BundleAnalyzerPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack-bundle-analyzer&#x27;</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: &#123;<br>        <span class="hljs-attr">app</span>: <span class="hljs-string">&#x27;./src/app.js&#x27;</span>,<br>        <span class="hljs-attr">app2</span>: <span class="hljs-string">&#x27;./src/app2.js&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(),<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">BundleAnalyzerPlugin</span>()<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>

<p>stat、parsed、Gzipped 3个按钮</p>
<p>每个按钮都有不同含义</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252223683.png" srcset="/img/loading.gif" lazyload alt="image-20220525222335621"></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205252224283.png" srcset="/img/loading.gif" lazyload alt="image-20220525222309218"></p>
<h2 id="拓展功能"><a href="#拓展功能" class="headerlink" title="拓展功能"></a>拓展功能</h2><h3 id="PostCSS与CSS模块"><a href="#PostCSS与CSS模块" class="headerlink" title="PostCSS与CSS模块"></a>PostCSS与CSS模块</h3><p>Postcss 是一个用 JavaScript 工具和插件转换CSS 代码的工具。比如可以使用 Autoprefixer 插件自动获取浏览器的流行度和能够支持的属性，并根据这些数据帮我们自动的为 CSS 规则添加前缀，将最新的 CSS 语法转换成大多数浏览器都能理解的语法。</p>
<p>css 模块 能让你永远不用担心命名太大众化而造成冲突，只要用最有意义的名字就行了。</p>
<p>app.css</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">body</span> &#123;<br>    <span class="hljs-attribute">background-color</span>: red;<br>    <span class="hljs-attribute">display</span>: flex;<br>&#125;<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install postcss-loader -D<br>npm install autoprefixer -D<br></code></pre></td></tr></table></figure>

<p>在根目录新建postcss.config.js文件，使用autoprefixer插件</p>
<h4 id="autoprefixer"><a href="#autoprefixer" class="headerlink" title="autoprefixer"></a>autoprefixer</h4><blockquote>
<p>PostCSS插件，用于解析CSS，并使用我可以使用的值将供应商前缀添加到CSS规则。它也是由谷歌推荐的，并在Twitter和阿里巴巴使用。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;autoprefixer&#x27;</span>)<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后在package.json加入配置</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-string">&quot;browserslist&quot;</span>: [<br>  <span class="hljs-string">&quot;&gt; 1%&quot;</span>, <span class="hljs-regexp">//</span>世界上大于<span class="hljs-number">1</span>%的浏览器<br>  <span class="hljs-string">&quot;last 2 version&quot;</span> <span class="hljs-regexp">//</span>最后<span class="hljs-number">2</span>个版本<br>]<br></code></pre></td></tr></table></figure>

<p>运行webpack server</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261100336.png" srcset="/img/loading.gif" lazyload alt="image-20220526110037237"></p>
<p>可以看到已经加入了每个浏览器适配的css语法</p>
<p>安装<code>postcss-nested</code>依赖，可以在css内写嵌套</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install postcss-nested -D<br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;autoprefixer&#x27;</span>),<br>        <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;postcss-nested&#x27;</span>)<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>

<p>CSS本身就不支持嵌套写法</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261130275.png" srcset="/img/loading.gif" lazyload alt="image-20220526113016199"></p>
<p>vsCode报错了，但是我们使用了postcss-nested插件帮助我们解析这种嵌套的写法，运行webpack server</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261130255.png" srcset="/img/loading.gif" lazyload alt="image-20220526113005126"></p>
<p>这是postcss-nested帮我们解析后的结果</p>
<h4 id="问题-2"><a href="#问题-2" class="headerlink" title="问题"></a>问题</h4><p>要是在别的css中也写了个.box这样就会冲突了。使用CSS模块来解决</p>
<p>修改webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">module</span>: &#123;<br>       <span class="hljs-attr">rules</span>: [<br>           &#123;<br>               <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>               <span class="hljs-attr">use</span>: [<br>                   <span class="hljs-string">&#x27;style-loader&#x27;</span>,<br>                   &#123;<br>                       <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>                       <span class="hljs-attr">options</span>: &#123;<br>                           <span class="hljs-attr">modules</span>: <span class="hljs-literal">true</span>,<br>                       &#125;<br>                   &#125;,<br>                   <span class="hljs-string">&#x27;postcss-loader&#x27;</span><br>               ]<br>           &#125;<br>       ]<br>   &#125;<br></code></pre></td></tr></table></figure>

<p>重新运行webpack server，发现样式失效了</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261151289.png" srcset="/img/loading.gif" lazyload alt="image-20220526115139158"></p>
<p>原因：css类名 变成了随机值，肯定样式不起作用了。</p>
<p>修改app.js引入css的写法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> style <span class="hljs-keyword">from</span>  <span class="hljs-string">&#x27;./app.css&#x27;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(style); <span class="hljs-comment">//打印一下</span><br><span class="hljs-keyword">const</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>)<br>div.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;hello&#x27;</span><br>div.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(style.<span class="hljs-property">box</span>)<br><span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(div)<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261313517.png" srcset="/img/loading.gif" lazyload alt="image-20220526131338386"></p>
<p>样式就恢复好了。（React也是这样的类似写法）</p>
<p>也可以开启CSS模块模式，比如全局样式可以冠以<code>.global</code>前缀，如：</p>
<ul>
<li><p>*.global.css        css普通模式</p>
</li>
<li><p>*.css                    css module模式</p>
</li>
</ul>
<p>这里统一用global关键字进行识别。用正则表达式匹配文件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>         <span class="hljs-attr">test</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">`^(?!.*\\.global).*\\.css$`</span>),  <span class="hljs-comment">//global.css 文件加入css模块化</span><br>         <span class="hljs-attr">use</span>: [<br>             <span class="hljs-string">&#x27;style-loader&#x27;</span>,<br>             &#123;<br>                 <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>                 <span class="hljs-attr">options</span>: &#123;<br>                     <span class="hljs-attr">modules</span>: &#123;<br>                         <span class="hljs-attr">localIdentName</span>: <span class="hljs-string">&#x27;[hash:base64:6]&#x27;</span><br>                     &#125;<br>                 &#125;<br>             &#125;,<br>             <span class="hljs-string">&#x27;postcss-loader&#x27;</span><br>         ]<br>     &#125;,<br>     &#123;<br>         <span class="hljs-attr">test</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">`^(.*\\.global).*\\.css$`</span>), <span class="hljs-comment">// 普通css 普通模式</span><br>         <span class="hljs-attr">use</span>: [<br>             <span class="hljs-string">&#x27;style-loader&#x27;</span>,<br>             <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>             <span class="hljs-string">&#x27;postcss-loader&#x27;</span><br>         ]<br>     &#125;,<br></code></pre></td></tr></table></figure>

<p>test.css</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.test1</span> &#123;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>test.global.css</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.test12</span> &#123;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">24px</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> style <span class="hljs-keyword">from</span>  <span class="hljs-string">&#x27;./app.css&#x27;</span><br><span class="hljs-keyword">import</span> test <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./test.css&#x27;</span><br><span class="hljs-keyword">import</span> testGlobal <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./test.global.css&#x27;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(style);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(test);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(testGlobal);<br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261326230.png" srcset="/img/loading.gif" lazyload alt="image-20220526132658089"></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261327251.png" srcset="/img/loading.gif" lazyload alt="image-20220526132712122"></p>
<h3 id="小结-6"><a href="#小结-6" class="headerlink" title="小结"></a>小结</h3><p>使用postcss可以帮我们把css解析为一个抽象语法树，调用一些插件处理这个抽象树，并添加一些特殊的功能。</p>
<p>为了防止css名称冲突，在css-loader中配置module为true，开启css模块化功能</p>
<h3 id="Web-Works"><a href="#Web-Works" class="headerlink" title="Web Works"></a>Web Works</h3><p>html5新特性，将负责、耗时的操作放到浏览器后台进程去处理，不影响JS主线程UI的渲染</p>
<p>webpack5内置了这个功能</p>
<p>创建work.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// web works</span><br><br>self.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> &#123;<br>    self.<span class="hljs-title function_">postMessage</span>(&#123;<br>        <span class="hljs-attr">answer</span>: <span class="hljs-number">1111</span><br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>创建app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">&#x27;./work.js&#x27;</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>))<br><br>worker.<span class="hljs-title function_">postMessage</span>(&#123;<br>    <span class="hljs-attr">question</span>: <span class="hljs-string">&quot;hi, how many the luck num today?&quot;</span><br>&#125;)<br><br>worker.<span class="hljs-property">onmessage</span> = <span class="hljs-function"><span class="hljs-params">message</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(message.<span class="hljs-property">data</span>.<span class="hljs-property">answer</span>)<br></code></pre></td></tr></table></figure>



<h3 id="TypeScript"><a href="#TypeScript" class="headerlink" title="TypeScript"></a>TypeScript</h3><p>安装依赖</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install typescript ts-loader -D<br></code></pre></td></tr></table></figure>

<p>配置webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/app.ts&#x27;</span>,<br>    <span class="hljs-attr">devtool</span>: <span class="hljs-string">&#x27;inline-source-map&#x27;</span>,<br>    <span class="hljs-attr">module</span>: &#123;<br>        <span class="hljs-attr">rules</span>: [<br>            &#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.ts$/</span>,<br>                <span class="hljs-attr">use</span>: <span class="hljs-string">&#x27;ts-loader&#x27;</span>,<br>                <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span><br>            &#125;<br>        ]<br>    &#125;,<br>    <span class="hljs-attr">resolve</span>: &#123;<br>        <span class="hljs-attr">extensions</span>: [<span class="hljs-string">&#x27;.ts&#x27;</span>, <span class="hljs-string">&#x27;.js&#x27;</span>]<br>    &#125;,<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;bundle.js&#x27;</span>,<br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>)<br>    &#125;,<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>()<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>

<p>编写src&#x2F;app.ts</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">12</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(age)<br></code></pre></td></tr></table></figure>

<p>运行webpack server</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261510405.png" srcset="/img/loading.gif" lazyload alt="image-20220526151052257"></p>
<p>执行<code>npx tsc --init</code></p>
<p>在根目录下生成tsconfig.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-comment">/* Visit https://aka.ms/tsconfig to read more about this file */</span><br><br>    <span class="hljs-comment">/* Projects */</span><br>    <span class="hljs-comment">// &quot;incremental&quot;: true,                              /* Save .tsbuildinfo files to allow for incremental compilation of projects. */</span><br>    <span class="hljs-comment">// &quot;composite&quot;: true,                                /* Enable constraints that allow a TypeScript project to be used with project references. */</span><br>    <span class="hljs-comment">// &quot;tsBuildInfoFile&quot;: &quot;./.tsbuildinfo&quot;,              /* Specify the path to .tsbuildinfo incremental compilation file. */</span><br>    <span class="hljs-comment">// &quot;disableSourceOfProjectReferenceRedirect&quot;: true,  /* Disable preferring source files instead of declaration files when referencing composite projects. */</span><br>    <span class="hljs-comment">// &quot;disableSolutionSearching&quot;: true,                 /* Opt a project out of multi-project reference checking when editing. */</span><br>    <span class="hljs-comment">// &quot;disableReferencedProjectLoad&quot;: true,             /* Reduce the number of projects loaded automatically by TypeScript. */</span><br><br>    <span class="hljs-comment">/* Language and Environment */</span><br>    <span class="hljs-attr">&quot;target&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;es2016&quot;</span><span class="hljs-punctuation">,</span>                                  <span class="hljs-comment">/* Set the JavaScript language version for emitted JavaScript and include compatible library declarations. */</span><br>    <span class="hljs-comment">// &quot;lib&quot;: [],                                        /* Specify a set of bundled library declaration files that describe the target runtime environment. */</span><br>    <span class="hljs-comment">// &quot;jsx&quot;: &quot;preserve&quot;,                                /* Specify what JSX code is generated. */</span><br>    <span class="hljs-comment">// &quot;experimentalDecorators&quot;: true,                   /* Enable experimental support for TC39 stage 2 draft decorators. */</span><br>    <span class="hljs-comment">// &quot;emitDecoratorMetadata&quot;: true,                    /* Emit design-type metadata for decorated declarations in source files. */</span><br>    <span class="hljs-comment">// &quot;jsxFactory&quot;: &quot;&quot;,                                 /* Specify the JSX factory function used when targeting React JSX emit, e.g. &#x27;React.createElement&#x27; or &#x27;h&#x27;. */</span><br>    <span class="hljs-comment">// &quot;jsxFragmentFactory&quot;: &quot;&quot;,                         /* Specify the JSX Fragment reference used for fragments when targeting React JSX emit e.g. &#x27;React.Fragment&#x27; or &#x27;Fragment&#x27;. */</span><br>    <span class="hljs-comment">// &quot;jsxImportSource&quot;: &quot;&quot;,                            /* Specify module specifier used to import the JSX factory functions when using &#x27;jsx: react-jsx*&#x27;. */</span><br>    <span class="hljs-comment">// &quot;reactNamespace&quot;: &quot;&quot;,                             /* Specify the object invoked for &#x27;createElement&#x27;. This only applies when targeting &#x27;react&#x27; JSX emit. */</span><br>    <span class="hljs-comment">// &quot;noLib&quot;: true,                                    /* Disable including any library files, including the default lib.d.ts. */</span><br>    <span class="hljs-comment">// &quot;useDefineForClassFields&quot;: true,                  /* Emit ECMAScript-standard-compliant class fields. */</span><br>    <span class="hljs-comment">// &quot;moduleDetection&quot;: &quot;auto&quot;,                        /* Control what method is used to detect module-format JS files. */</span><br><br>    <span class="hljs-comment">/* Modules */</span><br>    <span class="hljs-attr">&quot;module&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;commonjs&quot;</span><span class="hljs-punctuation">,</span>                                <span class="hljs-comment">/* Specify what module code is generated. */</span><br>    <span class="hljs-attr">&quot;rootDir&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;./src&quot;</span><span class="hljs-punctuation">,</span>                                  <span class="hljs-comment">/* Specify the root folder within your source files. */</span><br>    <span class="hljs-comment">// &quot;moduleResolution&quot;: &quot;node&quot;,                       /* Specify how TypeScript looks up a file from a given module specifier. */</span><br>    <span class="hljs-comment">// &quot;baseUrl&quot;: &quot;./&quot;,                                  /* Specify the base directory to resolve non-relative module names. */</span><br>    <span class="hljs-comment">// &quot;paths&quot;: &#123;&#125;,                                      /* Specify a set of entries that re-map imports to additional lookup locations. */</span><br>    <span class="hljs-comment">// &quot;rootDirs&quot;: [],                                   /* Allow multiple folders to be treated as one when resolving modules. */</span><br>    <span class="hljs-comment">// &quot;typeRoots&quot;: [],                                  /* Specify multiple folders that act like &#x27;./node_modules/@types&#x27;. */</span><br>    <span class="hljs-comment">// &quot;types&quot;: [],                                      /* Specify type package names to be included without being referenced in a source file. */</span><br>    <span class="hljs-comment">// &quot;allowUmdGlobalAccess&quot;: true,                     /* Allow accessing UMD globals from modules. */</span><br>    <span class="hljs-comment">// &quot;moduleSuffixes&quot;: [],                             /* List of file name suffixes to search when resolving a module. */</span><br>    <span class="hljs-comment">// &quot;resolveJsonModule&quot;: true,                        /* Enable importing .json files. */</span><br>    <span class="hljs-comment">// &quot;noResolve&quot;: true,                                /* Disallow &#x27;import&#x27;s, &#x27;require&#x27;s or &#x27;&lt;reference&gt;&#x27;s from expanding the number of files TypeScript should add to a project. */</span><br><br>    <span class="hljs-comment">/* JavaScript Support */</span><br>    <span class="hljs-comment">// &quot;allowJs&quot;: true,                                  /* Allow JavaScript files to be a part of your program. Use the &#x27;checkJS&#x27; option to get errors from these files. */</span><br>    <span class="hljs-comment">// &quot;checkJs&quot;: true,                                  /* Enable error reporting in type-checked JavaScript files. */</span><br>    <span class="hljs-comment">// &quot;maxNodeModuleJsDepth&quot;: 1,                        /* Specify the maximum folder depth used for checking JavaScript files from &#x27;node_modules&#x27;. Only applicable with &#x27;allowJs&#x27;. */</span><br><br>    <span class="hljs-comment">/* Emit */</span><br>    <span class="hljs-comment">// &quot;declaration&quot;: true,                              /* Generate .d.ts files from TypeScript and JavaScript files in your project. */</span><br>    <span class="hljs-comment">// &quot;declarationMap&quot;: true,                           /* Create sourcemaps for d.ts files. */</span><br>    <span class="hljs-comment">// &quot;emitDeclarationOnly&quot;: true,                      /* Only output d.ts files and not JavaScript files. */</span><br>    <span class="hljs-comment">// &quot;sourceMap&quot;: true,                                /* Create source map files for emitted JavaScript files. */</span><br>    <span class="hljs-comment">// &quot;outFile&quot;: &quot;./&quot;,                                  /* Specify a file that bundles all outputs into one JavaScript file. If &#x27;declaration&#x27; is true, also designates a file that bundles all .d.ts output. */</span><br>    <span class="hljs-attr">&quot;outDir&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;./dist&quot;</span><span class="hljs-punctuation">,</span>                                   <span class="hljs-comment">/* Specify an output folder for all emitted files. */</span><br>    <span class="hljs-comment">// &quot;removeComments&quot;: true,                           /* Disable emitting comments. */</span><br>    <span class="hljs-comment">// &quot;noEmit&quot;: true,                                   /* Disable emitting files from a compilation. */</span><br>    <span class="hljs-comment">// &quot;importHelpers&quot;: true,                            /* Allow importing helper functions from tslib once per project, instead of including them per-file. */</span><br>    <span class="hljs-comment">// &quot;importsNotUsedAsValues&quot;: &quot;remove&quot;,               /* Specify emit/checking behavior for imports that are only used for types. */</span><br>    <span class="hljs-comment">// &quot;downlevelIteration&quot;: true,                       /* Emit more compliant, but verbose and less performant JavaScript for iteration. */</span><br>    <span class="hljs-comment">// &quot;sourceRoot&quot;: &quot;&quot;,                                 /* Specify the root path for debuggers to find the reference source code. */</span><br>    <span class="hljs-comment">// &quot;mapRoot&quot;: &quot;&quot;,                                    /* Specify the location where debugger should locate map files instead of generated locations. */</span><br>    <span class="hljs-comment">// &quot;inlineSourceMap&quot;: true,                          /* Include sourcemap files inside the emitted JavaScript. */</span><br>    <span class="hljs-comment">// &quot;inlineSources&quot;: true,                            /* Include source code in the sourcemaps inside the emitted JavaScript. */</span><br>    <span class="hljs-comment">// &quot;emitBOM&quot;: true,                                  /* Emit a UTF-8 Byte Order Mark (BOM) in the beginning of output files. */</span><br>    <span class="hljs-comment">// &quot;newLine&quot;: &quot;crlf&quot;,                                /* Set the newline character for emitting files. */</span><br>    <span class="hljs-comment">// &quot;stripInternal&quot;: true,                            /* Disable emitting declarations that have &#x27;@internal&#x27; in their JSDoc comments. */</span><br>    <span class="hljs-comment">// &quot;noEmitHelpers&quot;: true,                            /* Disable generating custom helper functions like &#x27;__extends&#x27; in compiled output. */</span><br>    <span class="hljs-comment">// &quot;noEmitOnError&quot;: true,                            /* Disable emitting files if any type checking errors are reported. */</span><br>    <span class="hljs-comment">// &quot;preserveConstEnums&quot;: true,                       /* Disable erasing &#x27;const enum&#x27; declarations in generated code. */</span><br>    <span class="hljs-comment">// &quot;declarationDir&quot;: &quot;./&quot;,                           /* Specify the output directory for generated declaration files. */</span><br>    <span class="hljs-comment">// &quot;preserveValueImports&quot;: true,                     /* Preserve unused imported values in the JavaScript output that would otherwise be removed. */</span><br><br>    <span class="hljs-comment">/* Interop Constraints */</span><br>    <span class="hljs-comment">// &quot;isolatedModules&quot;: true,                          /* Ensure that each file can be safely transpiled without relying on other imports. */</span><br>    <span class="hljs-comment">// &quot;allowSyntheticDefaultImports&quot;: true,             /* Allow &#x27;import x from y&#x27; when a module doesn&#x27;t have a default export. */</span><br>    <span class="hljs-attr">&quot;esModuleInterop&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span>                             <span class="hljs-comment">/* Emit additional JavaScript to ease support for importing CommonJS modules. This enables &#x27;allowSyntheticDefaultImports&#x27; for type compatibility. */</span><br>    <span class="hljs-comment">// &quot;preserveSymlinks&quot;: true,                         /* Disable resolving symlinks to their realpath. This correlates to the same flag in node. */</span><br>    <span class="hljs-attr">&quot;forceConsistentCasingInFileNames&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span>            <span class="hljs-comment">/* Ensure that casing is correct in imports. */</span><br><br>    <span class="hljs-comment">/* Type Checking */</span><br>    <span class="hljs-attr">&quot;strict&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span>                                      <span class="hljs-comment">/* Enable all strict type-checking options. */</span><br>    <span class="hljs-comment">// &quot;noImplicitAny&quot;: true,                            /* Enable error reporting for expressions and declarations with an implied &#x27;any&#x27; type. */</span><br>    <span class="hljs-comment">// &quot;strictNullChecks&quot;: true,                         /* When type checking, take into account &#x27;null&#x27; and &#x27;undefined&#x27;. */</span><br>    <span class="hljs-comment">// &quot;strictFunctionTypes&quot;: true,                      /* When assigning functions, check to ensure parameters and the return values are subtype-compatible. */</span><br>    <span class="hljs-comment">// &quot;strictBindCallApply&quot;: true,                      /* Check that the arguments for &#x27;bind&#x27;, &#x27;call&#x27;, and &#x27;apply&#x27; methods match the original function. */</span><br>    <span class="hljs-comment">// &quot;strictPropertyInitialization&quot;: true,             /* Check for class properties that are declared but not set in the constructor. */</span><br>    <span class="hljs-comment">// &quot;noImplicitThis&quot;: true,                           /* Enable error reporting when &#x27;this&#x27; is given the type &#x27;any&#x27;. */</span><br>    <span class="hljs-comment">// &quot;useUnknownInCatchVariables&quot;: true,               /* Default catch clause variables as &#x27;unknown&#x27; instead of &#x27;any&#x27;. */</span><br>    <span class="hljs-comment">// &quot;alwaysStrict&quot;: true,                             /* Ensure &#x27;use strict&#x27; is always emitted. */</span><br>    <span class="hljs-comment">// &quot;noUnusedLocals&quot;: true,                           /* Enable error reporting when local variables aren&#x27;t read. */</span><br>    <span class="hljs-comment">// &quot;noUnusedParameters&quot;: true,                       /* Raise an error when a function parameter isn&#x27;t read. */</span><br>    <span class="hljs-comment">// &quot;exactOptionalPropertyTypes&quot;: true,               /* Interpret optional property types as written, rather than adding &#x27;undefined&#x27;. */</span><br>    <span class="hljs-comment">// &quot;noImplicitReturns&quot;: true,                        /* Enable error reporting for codepaths that do not explicitly return in a function. */</span><br>    <span class="hljs-comment">// &quot;noFallthroughCasesInSwitch&quot;: true,               /* Enable error reporting for fallthrough cases in switch statements. */</span><br>    <span class="hljs-comment">// &quot;noUncheckedIndexedAccess&quot;: true,                 /* Add &#x27;undefined&#x27; to a type when accessed using an index. */</span><br>    <span class="hljs-comment">// &quot;noImplicitOverride&quot;: true,                       /* Ensure overriding members in derived classes are marked with an override modifier. */</span><br>    <span class="hljs-comment">// &quot;noPropertyAccessFromIndexSignature&quot;: true,       /* Enforces using indexed accessors for keys declared using an indexed type. */</span><br>    <span class="hljs-comment">// &quot;allowUnusedLabels&quot;: true,                        /* Disable error reporting for unused labels. */</span><br>    <span class="hljs-comment">// &quot;allowUnreachableCode&quot;: true,                     /* Disable error reporting for unreachable code. */</span><br><br>    <span class="hljs-comment">/* Completeness */</span><br>    <span class="hljs-comment">// &quot;skipDefaultLibCheck&quot;: true,                      /* Skip type checking .d.ts files that are included with TypeScript. */</span><br>    <span class="hljs-attr">&quot;skipLibCheck&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span>                                 <span class="hljs-comment">/* Skip type checking all .d.ts files. */</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>



<p>将需要的配置打开。这里只开启了<code>rootDir</code> 和 <code>outDir</code> 这2个配置</p>
<p>引入lodash依赖，发现ts引入第三方依赖都需要定义个模块的概念</p>
<p><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/dt/search?search=lodash">搜索模块</a> 进入后搜索相应依赖的模块，进行安装</p>
<h3 id="多页面应用"><a href="#多页面应用" class="headerlink" title="多页面应用"></a>多页面应用</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>()<br>    ],<br>    <span class="hljs-attr">entry</span>: &#123;<br>        <span class="hljs-attr">main</span>: &#123;<br>            <span class="hljs-attr">import</span>: [<span class="hljs-string">&#x27;./src/app2.js&#x27;</span>, <span class="hljs-string">&#x27;./src/app.js&#x27;</span>],<br>            <span class="hljs-attr">dependOn</span>: <span class="hljs-string">&#x27;lodash&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">lodash</span>: <span class="hljs-string">&#x27;lodash&#x27;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261542858.png" srcset="/img/loading.gif" lazyload alt="image-20220526154230759"></p>
<p> 创建个app3.js 并引入lodash依赖 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>()<br>    ],<br>    <span class="hljs-attr">entry</span>: &#123;<br>        <span class="hljs-attr">main</span>: &#123;<br>            <span class="hljs-attr">import</span>: [<span class="hljs-string">&#x27;./src/app2.js&#x27;</span>, <span class="hljs-string">&#x27;./src/app.js&#x27;</span>],<br>            <span class="hljs-attr">dependOn</span>: <span class="hljs-string">&#x27;lodash&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">main2</span>: &#123;<br>            <span class="hljs-attr">import</span>: [<span class="hljs-string">&#x27;./src/app3.js&#x27;</span>],<br>            <span class="hljs-attr">dependOn</span>: <span class="hljs-string">&#x27;lodash&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">lodash</span>: <span class="hljs-string">&#x27;lodash&#x27;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261544684.png" srcset="/img/loading.gif" lazyload alt="image-20220526154451604"></p>
<p>打包后的html文件</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205261550802.png" srcset="/img/loading.gif" lazyload alt="image-20220526155021713"></p>
<p>能不能将mian.js放在一个html、main2.js放在另外一个html </p>
<p>先在根目录创建个<code>index.html</code>，修改webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>            <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;./index.html&#x27;</span>,<br>            <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;多页面应用功能&#x27;</span>, <span class="hljs-comment">// index.html 页面内可以使用ejs语法注入这个变量 &lt;title&gt;&lt;%= htmlWebpackPlugin.options.title %&gt;&lt;/title&gt;</span><br>            <span class="hljs-attr">inject</span>: <span class="hljs-string">&#x27;body&#x27;</span>, <span class="hljs-comment">// 定义注入的位置</span><br>            <span class="hljs-attr">chunks</span>: [<span class="hljs-string">&#x27;main&#x27;</span>], <span class="hljs-comment">//使用entry对象中哪些chunk</span><br>        &#125;)<br>    ],<br>    <span class="hljs-attr">entry</span>: &#123;<br>        <span class="hljs-attr">main</span>: &#123;<br>            <span class="hljs-attr">import</span>: [<span class="hljs-string">&#x27;./src/app2.js&#x27;</span>, <span class="hljs-string">&#x27;./src/app.js&#x27;</span>],<br>            <span class="hljs-attr">dependOn</span>: <span class="hljs-string">&#x27;lodash&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">main2</span>: &#123;<br>            <span class="hljs-attr">import</span>: [<span class="hljs-string">&#x27;./src/app3.js&#x27;</span>],<br>            <span class="hljs-attr">dependOn</span>: <span class="hljs-string">&#x27;lodash&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">lodash</span>: <span class="hljs-string">&#x27;lodash&#x27;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>上面的配置，还是单页面，只是我们可以指定哪些chunk注入到哪个html文件的位置，按照这个思路，我们在新建个HtmlWebpackPlugin就行啦。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>            <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;./index.html&#x27;</span>,<br>            <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;多页面应用功能&#x27;</span>,<br>            <span class="hljs-attr">inject</span>: <span class="hljs-string">&#x27;body&#x27;</span>, <span class="hljs-comment">// 定义注入的位置</span><br>        &#125;),<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>            <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;./index2.html&#x27;</span>,<br>            <span class="hljs-attr">inject</span>: <span class="hljs-string">&#x27;body&#x27;</span>,<br>        &#125;)<br>    ]<br></code></pre></td></tr></table></figure>

<p>现在先不指定chunk，看看默认webpack如何运行，但是运行报错了，原因是我们2个html打包后都叫同一个名称<code>index.html</code>，修改配置文件，再试试。</p>
<p>打包完成后，发现2个html的引入js文件都是一样的。都是entry的3个 <code>main</code>, <code>main2</code>, <code>lodash</code></p>
<p>创建个index2.html，并且修改下webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>            <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;./index.html&#x27;</span>,<br>            <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;多页面应用功能&#x27;</span>,<br>            <span class="hljs-attr">inject</span>: <span class="hljs-string">&#x27;body&#x27;</span>, <span class="hljs-comment">// 定义注入的位置</span><br>            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;chanel1/index.html&#x27;</span>, <span class="hljs-comment">//配置html生成后的打包路径</span><br>            <span class="hljs-attr">chunks</span>: [<span class="hljs-string">&#x27;main&#x27;</span>, <span class="hljs-string">&#x27;lodash&#x27;</span>] <span class="hljs-comment">// 使用main和lodash这个2个chunk</span><br>        &#125;),<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>            <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;./index2.html&#x27;</span>,<br>            <span class="hljs-attr">inject</span>: <span class="hljs-string">&#x27;body&#x27;</span>,<br>            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;chanel2/index2.html&#x27;</span>, <span class="hljs-comment">//配置html生成后的打包路径</span><br>            <span class="hljs-attr">chunks</span>: [<span class="hljs-string">&#x27;main2&#x27;</span>, <span class="hljs-string">&#x27;lodash&#x27;</span>] <span class="hljs-comment">// 使用main2和lodash这个2个chunk</span><br>        &#125;)<br>    ],<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span><br>    &#125;,<br>    <span class="hljs-attr">entry</span>: &#123;<br>        <span class="hljs-attr">main</span>: &#123;<br>            <span class="hljs-attr">import</span>: [<span class="hljs-string">&#x27;./src/app2.js&#x27;</span>, <span class="hljs-string">&#x27;./src/app.js&#x27;</span>],<br>            <span class="hljs-attr">dependOn</span>: <span class="hljs-string">&#x27;lodash&#x27;</span>,<br>            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;chanel1/[name].js&#x27;</span> <span class="hljs-comment">//配置js生成后的打包路径</span><br>        &#125;,<br>        <span class="hljs-attr">main2</span>: &#123;<br>            <span class="hljs-attr">import</span>: [<span class="hljs-string">&#x27;./src/app3.js&#x27;</span>],<br>            <span class="hljs-attr">dependOn</span>: <span class="hljs-string">&#x27;lodash&#x27;</span>,<br>            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;chanel2/[name].js&#x27;</span> <span class="hljs-comment">////配置js生成后的打包路径 </span><br>        &#125;,<br>        <span class="hljs-attr">lodash</span>: &#123;<br>            <span class="hljs-attr">import</span>: [<span class="hljs-string">&#x27;lodash&#x27;</span>],<br>            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;common/[name].js&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>






<h3 id="Tree-Shaking"><a href="#Tree-Shaking" class="headerlink" title="Tree Shaking"></a>Tree Shaking</h3><p>配置webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/app.js&#x27;</span>,<br>    <span class="hljs-attr">devtool</span>: <span class="hljs-string">&#x27;inline-source-map&#x27;</span>,<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>()<br>    ],<br>    <span class="hljs-attr">optimization</span>: &#123;<br>        <span class="hljs-attr">usedExports</span>: <span class="hljs-literal">true</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>创建math.js 与 app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// math.js</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">x, y</span>) =&gt; x + y<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">minus</span> = (<span class="hljs-params">x, y</span>) =&gt; x - y<br><span class="hljs-comment">// app.js</span><br><span class="hljs-keyword">import</span> &#123; add, minus &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./math&#x27;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">5</span>, <span class="hljs-number">6</span>));<br></code></pre></td></tr></table></figure>

<p>运行<code>npx webpack</code>打包整个代码</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205262050464.png" srcset="/img/loading.gif" lazyload alt="image-20220526205056364"></p>
<p>发现minus没有使用到，因为app.js 只使用了add方法，达到目的</p>
<p>修改下webpack.config.js为生产环境</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;production&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/app.js&#x27;</span>,<br>    <span class="hljs-comment">// devtool: &#x27;inline-source-map&#x27;,</span><br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>()<br>    ],<br>    <span class="hljs-attr">optimization</span>: &#123;<br>        <span class="hljs-attr">usedExports</span>: <span class="hljs-literal">true</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>发现打包后的代码 .&#x2F;dist&#x2F;main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">(<span class="hljs-function">()=&gt;</span>&#123;<span class="hljs-string">&quot;use strict&quot;</span>;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">11</span>)&#125;)();<br></code></pre></td></tr></table></figure>

<p>说明webpack帮我们优化到了极致，这个时候这变成了一行代码了。</p>
<p>那么引入第三方库呢，如lodash</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 全部引入</span><br><span class="hljs-keyword">import</span> _ <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;lodash&#x27;</span>;<br><span class="hljs-comment">// 部分引入</span><br><span class="hljs-keyword">import</span> &#123;get&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;lodash&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p>测试发现，上面的两种引入方式，不管你是否使用，都会把整个lodash打包进来。</p>
<p>这是因为lodash是通过moduls.<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=exports&spm=1001.2101.3001.7020">exports</a> &#x3D; _这种方式导出的。</p>
<p>还好lodash提供了按需引入模式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> get <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;lodash/get&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p>上面的方式引入，只会引入get.js文件，其它模块都不会加载进来。</p>
<h3 id="sideEffects"><a href="#sideEffects" class="headerlink" title="sideEffects"></a>sideEffects</h3><p>若开启，则引入css</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;./xxxx.css&#x27;</span><br></code></pre></td></tr></table></figure>

<p>会起作用</p>
<p>修改package.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;sideEffects&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;*.css&quot;</span> <span class="hljs-punctuation">,</span><span class="hljs-string">&quot;*.scss&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;*.global.js&quot;</span>...<span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;sideEffects&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">false</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 所有引入没使用的，都会被排除掉</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;sideEffects&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 所有引入没使用的，都不会被排除掉</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>如果不需要某些文件被 webpack 清除，可以在 package.json 中配置 sideEffects 属性</p>
<h3 id="渐进式网络应用程序-PWA"><a href="#渐进式网络应用程序-PWA" class="headerlink" title="渐进式网络应用程序 PWA"></a>渐进式网络应用程序 PWA</h3><h3 id="shimming-预置依赖"><a href="#shimming-预置依赖" class="headerlink" title="shimming 预置依赖"></a>shimming 预置依赖</h3><p>配置webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(),<br>        <span class="hljs-keyword">new</span> webpack.<span class="hljs-title class_">ProvidePlugin</span>(&#123;<br>            <span class="hljs-attr">_</span>: <span class="hljs-string">&#x27;lodash&#x27;</span> <span class="hljs-comment">//将lodash放在全局依赖下</span><br>        &#125;)<br>    ],<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs index.js">// import _ from &#x27;lodash&#x27;<br>console.log(_.join([&#x27;hello&#x27;, &#x27;Zoe&#x27;], &#x27; &#x27;));<br></code></pre></td></tr></table></figure>

<p>去掉import引入lodash的语句，直接使用<code>_</code>，运行webpack，打包完成～</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205271012605.png" srcset="/img/loading.gif" lazyload alt="image-20220527101229462"></p>
<p>可以看出lodash的大小在打包后的main.js内</p>
<h4 id="细粒度-Shimming"><a href="#细粒度-Shimming" class="headerlink" title="细粒度 Shimming"></a>细粒度 Shimming</h4><p>修改index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">this</span>.<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;hello&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>运行webpack server</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205271029332.png" srcset="/img/loading.gif" lazyload alt="image-20220527102906238"></p>
<p>修改webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">module</span>: &#123;<br>        <span class="hljs-attr">rules</span>: [<br>            &#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-built_in">require</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;./src/index.js&#x27;</span>), <span class="hljs-comment">// 解析到./src/index.js使用下面的loader去处理</span><br>                <span class="hljs-attr">use</span>: <span class="hljs-string">&#x27;imports-loader?wrapper=window&#x27;</span>, <span class="hljs-comment">// 将当前的this指向window对象</span><br>            &#125;<br>        ]<br>    &#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205271032174.png" srcset="/img/loading.gif" lazyload alt="image-20220527103203033"></p>
<h3 id="全局exports"><a href="#全局exports" class="headerlink" title="全局exports"></a>全局exports</h3><p>项目内创建个globals.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> file = <span class="hljs-string">&#x27;example.txt&#x27;</span><br><br><span class="hljs-keyword">const</span> helpers = &#123;<br>    <span class="hljs-attr">test</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;test something&#x27;</span>);<br>    &#125;,<br><br>    <span class="hljs-attr">parse</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;parse something&#x27;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们只使用这个文件的某个方法，不需要导入整个文件。</p>
<p>安装exports-loader</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install exports-loader -D<br></code></pre></td></tr></table></figure>

<p>配置webpack.config.js.     <a target="_blank" rel="noopener" href="https://webpack.js.org/loaders/exports-loader/">exports-loader官方文档</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js">						&#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-built_in">require</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;./src/globals.js&#x27;</span>),<br>                <span class="hljs-attr">use</span>: <span class="hljs-string">&#x27;exports-loader?type=commonjs&amp;exports=file,multiple|helpers.parse|parse&#x27;</span><br>            &#125;<br><br><span class="hljs-comment">// =&gt; </span><br>&#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-built_in">require</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;./src/globals.js&#x27;</span>),<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;exports-loader&#x27;</span>,<br>                <span class="hljs-attr">options</span>: &#123;<br>                    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;commonjs&#x27;</span>,<br>                    <span class="hljs-attr">exports</span>: [<span class="hljs-string">&#x27;file&#x27;</span>, <span class="hljs-string">&#x27;multiple helpers.parse parse&#x27;</span>]<br>                &#125;,<br>&#125;<br></code></pre></td></tr></table></figure>

<p>业务代码中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; file, parse &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./globals&#x27;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(file);<br><span class="hljs-title function_">parse</span>()<br></code></pre></td></tr></table></figure>

<p>将不同模块的js库，以commonjs的形式进行导入，并只使用里面在webpack.config.js里面exports的相应变量名称</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205271042701.png" srcset="/img/loading.gif" lazyload alt="image-20220527104235607"></p>
<h3 id="加载polyfills"><a href="#加载polyfills" class="headerlink" title="加载polyfills"></a>加载polyfills</h3><p>创建src&#x2F;index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;@babel/polyfill&#x27;</span><br><span class="hljs-comment">// Array.from不是所有浏览器都支持的</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x + x));<br></code></pre></td></tr></table></figure>

<p>创建webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>运行webpack打包发现打包出来main.js多了些浏览器兼容的代码，保证了向下兼容</p>
<h4 id="优化polyfills"><a href="#优化polyfills" class="headerlink" title="优化polyfills"></a>优化polyfills</h4><p>不建议使用 <code>import @babel/polyfill</code>。因为这样做的缺点是会全局引入整个 polyfill包，比如 Array.from 会全局引入，不但包的体积大，而且还会污染全局环境。</p>
<p>babel-preset-env package 通过 browserslist 来转译那些你浏览器中不支持的特性。这个 preset 使用useBuiltIns 选项，默认值是 false，这种方式可以将全局 babel-polyfill 导入，改进为更细粒度的import 格式：</p>
<p>安装依赖</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install babel-loader @babel/core @babel/preset-env -D  <br>npm install core-js@3 -D<br></code></pre></td></tr></table></figure>

<p>修改webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;development&quot;</span>,<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/index.js&quot;</span>,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>        <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,<br>        <span class="hljs-attr">use</span>: &#123;<br>          <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">presets</span>: [<br>              [<br>                <span class="hljs-string">&quot;@babel/preset-env&quot;</span>,<br>                &#123;<br>                  <span class="hljs-attr">targets</span>: [<span class="hljs-string">&quot;last 1 version&quot;</span>, <span class="hljs-string">&quot;&gt; 1%&quot;</span>],<br>                  <span class="hljs-attr">useBuiltIns</span>: <span class="hljs-string">&quot;usage&quot;</span>,<br>                  <span class="hljs-attr">corejs</span>: <span class="hljs-number">3</span>,<br>                &#125;,<br>              ],<br>            ],<br>          &#125;,<br>        &#125;,<br>      &#125;,<br>    ],<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure>



<h3 id="创建library"><a href="#创建library" class="headerlink" title="创建library"></a>创建library</h3><p>创建<code>src/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">x, y</span>) =&gt; x + y<br></code></pre></td></tr></table></figure>

<p>创建webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;production&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;mylib.js&#x27;</span>,<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>发现打包的mylib.js是空的，因为production模式下默认会排除掉没有使用的代码，加入library属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;production&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;mylib.js&#x27;</span>,<br>        <span class="hljs-attr">library</span>: <span class="hljs-string">&#x27;mylib&#x27;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>上面的写法支持script引入的</p>
<p>改为commonjs</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;production&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;mylib.js&#x27;</span>,<br>        <span class="hljs-attr">library</span>: &#123;<br>        	<span class="hljs-attr">name</span>: <span class="hljs-string">&quot;mylib&quot;</span>,<br>          <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;commonjs&quot;</span><br>        &#125;,<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>改为esModule</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;production&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">experiments</span>: &#123;<br>      <span class="hljs-attr">outputModule</span>: <span class="hljs-literal">true</span><br>    &#125;,<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;mylib.js&#x27;</span>,<br>        <span class="hljs-attr">library</span>: &#123;<br>        	<span class="hljs-comment">// name: &quot;mylib&quot;,</span><br>          <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;module&quot;</span><br>        &#125;,<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>改为umd（支持commons、script、umd）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;production&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;mylib.js&#x27;</span>,<br>        <span class="hljs-attr">library</span>: &#123;<br>        	<span class="hljs-attr">name</span>: <span class="hljs-string">&quot;mylib&quot;</span>,<br>          <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;umd&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">globalObject</span>: <span class="hljs-string">&#x27;globalThis&#x27;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>





<h3 id="创建一个lib轮子"><a href="#创建一个lib轮子" class="headerlink" title="创建一个lib轮子"></a>创建一个lib轮子</h3><p>安装依赖</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install webpack webpack-cli lodash -D<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs webpack.config.js">const path = require(&#x27;path&#x27;)<br>module.exports = &#123;<br>    mode: &#x27;production&#x27;,<br>    entry: &#x27;./src/index.js&#x27;,<br>    output: &#123;<br>        path: path.resolve(__dirname, &#x27;dist&#x27;),<br>        filename: &#x27;webpack-numbers.js&#x27;,<br>        library: &#123;<br>            name: &#x27;webpackNumbers&#x27;,<br>            type: &#x27;umd&#x27;<br>        &#125;,<br>        globalObject: &#x27;globalThis&#x27;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205282227861.png" srcset="/img/loading.gif" lazyload alt="image-20220528222712712"></p>
<p>lodash都打到包了，但是不想整个都导入</p>
<p>使用<a target="_blank" rel="noopener" href="https://webpack.docschina.org/configuration/externals/#externals">externals属性</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;production&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;webpack-numbers.js&#x27;</span>,<br>        <span class="hljs-attr">library</span>: &#123;<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;webpackNumbers&#x27;</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;umd&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">globalObject</span>: <span class="hljs-string">&#x27;globalThis&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">externals</span>: &#123;<br>        <span class="hljs-attr">lodash</span>: &#123;<br>            <span class="hljs-attr">commonjs</span>: <span class="hljs-string">&#x27;lodash&#x27;</span>,<br>            <span class="hljs-attr">commonjs2</span>: <span class="hljs-string">&#x27;lodash&#x27;</span>,<br>            <span class="hljs-attr">amd</span>: <span class="hljs-string">&#x27;lodash&#x27;</span>,<br>            <span class="hljs-attr">root</span>: <span class="hljs-string">&#x27;_&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205282229082.png" srcset="/img/loading.gif" lazyload alt="image-20220528222944938"></p>
<h4 id="发布到npm仓库"><a href="#发布到npm仓库" class="headerlink" title="发布到npm仓库"></a>发布到npm仓库</h4><p>首先在npm仓库注册这个的号，并登陆</p>
<p>在项目根目录下运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm adduser<br>// 输入用户名、密码、邮箱<br>// 登陆成功后<br>npm publish<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291305451.png" srcset="/img/loading.gif" lazyload alt="image-20220529130511388"></p>
<p>自己的仓库多了个</p>
<p>创建个新的目录，尝试将我们刚发布上npm仓库的包拉下来使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> webpackNumbers = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;02-webpack-publish-demo&#x27;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webpackNumbers);<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291308306.png" srcset="/img/loading.gif" lazyload alt="image-20220529130818228"></p>
<p>发现我们刚才打的包，package.json没有设置好。重新设置一下。</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291310046.png" srcset="/img/loading.gif" lazyload alt="image-20220529131056965"></p>
<p>发布上去后，将原来的根目录下的package.json修改下版本号就可以了。</p>
<h3 id="模块联邦-Module-Federation"><a href="#模块联邦-Module-Federation" class="headerlink" title="模块联邦(Module Federation)"></a>模块联邦(Module Federation)</h3><p>微前端的知识</p>
<p>创建3个webpack应用</p>
<table>
<thead>
<tr>
<th>Home</th>
<th>Nav</th>
<th>Search</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="http://localohost:3001/">http://localohost:3001</a></td>
<td><a target="_blank" rel="noopener" href="http://localohost:3003/">http://localohost:3003</a></td>
<td><a target="_blank" rel="noopener" href="http://localohost:3002/">http://localohost:3002</a></td>
</tr>
</tbody></table>
<h4 id="Nav"><a href="#Nav" class="headerlink" title="Nav"></a>Nav</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">Header</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> header = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;h1&#x27;</span>)<br>    header.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;公共头部内容&#x27;</span><br>    <span class="hljs-keyword">return</span> header  <br>&#125;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Header</span> <br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">ModuleFederationPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack&#x27;</span>).<span class="hljs-property">container</span><br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;production&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">plugins</span>:[<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(),<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModuleFederationPlugin</span>(&#123;<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;nav&#x27;</span>, <span class="hljs-comment">//名称</span><br>            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;remoteEntry.js&#x27;</span>, <span class="hljs-comment">//外部应用引入这个应用时候，使用这个文件名</span><br>            <span class="hljs-attr">remotes</span>: &#123;&#125;,<br>            <span class="hljs-attr">exposes</span>: &#123;<br>                <span class="hljs-string">&#x27;./Header&#x27;</span>: <span class="hljs-string">&#x27;./src/Header.js&#x27;</span>, <span class="hljs-comment">// 导出的组件</span><br>            &#125;,<br>            <span class="hljs-attr">shared</span>: &#123;&#125;<br>        &#125;)<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291518013.png" srcset="/img/loading.gif" lazyload alt="image-20220529151843957"></p>
<h4 id="Home"><a href="#Home" class="headerlink" title="Home"></a>Home</h4><p>引用nav应用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">HomeList</span> = (<span class="hljs-params">num</span>) =&gt; &#123;<br>    <span class="hljs-keyword">let</span> str = <span class="hljs-string">&#x27;&lt;ul&gt;&#x27;</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; num; i++) &#123;<br>        <span class="hljs-comment">// str += `&lt;li&gt;item$&#123;num&#125;&lt;/li&gt;`</span><br>        str += <span class="hljs-string">&#x27;&lt;li&gt;item&#x27;</span>+ i +<span class="hljs-string">&#x27;&lt;/li&gt;&#x27;</span><br>    &#125;<br>    str += <span class="hljs-string">&#x27;&lt;/ul&gt;&#x27;</span><br>    <span class="hljs-keyword">return</span> str<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">HomeList</span><br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">ModuleFederationPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack&#x27;</span>).<span class="hljs-property">container</span><br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;production&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">plugins</span>:[<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(),<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModuleFederationPlugin</span>(&#123;<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;home&#x27;</span>,<br>            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;remoteEntry.js&#x27;</span>,<br>            <span class="hljs-attr">remotes</span>: &#123;<br>                <span class="hljs-attr">nav</span>: <span class="hljs-string">&#x27;nav@http://localhost:3003/remoteEntry.js&#x27;</span>,<br>            &#125;,<br>            <span class="hljs-attr">exposes</span>: &#123;<br>                <span class="hljs-string">&#x27;./HomeList&#x27;</span>: <span class="hljs-string">&#x27;./src/HomeList.js&#x27;</span><br>            &#125;,<br>            <span class="hljs-attr">shared</span>: &#123;&#125;<br>        &#125;)<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// index.js</span><br><span class="hljs-keyword">import</span> a <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./HomeList&#x27;</span><br><span class="hljs-keyword">import</span> (<span class="hljs-string">&#x27;nav/Header&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">Header</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> body = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>)<br>    body.<span class="hljs-title function_">appendChild</span>(<span class="hljs-title class_">Header</span>.<span class="hljs-title function_">default</span>())<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(body)<br>    body.<span class="hljs-property">innerHTML</span> += <span class="hljs-title function_">a</span>(<span class="hljs-number">5</span>)<br>&#125;)<br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291519024.png" srcset="/img/loading.gif" lazyload alt="image-20220529151919976"></p>
<h4 id="search"><a href="#search" class="headerlink" title="search"></a>search</h4><p>引用nav与home应用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// index.js</span><br><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;nav/Header&#x27;</span>), <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;home/HomeList&#x27;</span>)])<br>    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">[</span></span><br><span class="hljs-params"><span class="hljs-function">        &#123;</span></span><br><span class="hljs-params"><span class="hljs-function">            <span class="hljs-keyword">default</span>: Header</span></span><br><span class="hljs-params"><span class="hljs-function">        &#125;,</span></span><br><span class="hljs-params"><span class="hljs-function">        &#123;</span></span><br><span class="hljs-params"><span class="hljs-function">            <span class="hljs-keyword">default</span>: HomeList</span></span><br><span class="hljs-params"><span class="hljs-function">        &#125;</span></span><br><span class="hljs-params"><span class="hljs-function">    ]</span>) =&gt;</span> &#123;<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-title class_">Header</span>())<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">innerHTML</span> += <span class="hljs-title class_">HomeList</span>(<span class="hljs-number">3</span>)<br>    &#125;)<br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">ModuleFederationPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack&#x27;</span>).<span class="hljs-property">container</span><br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;production&#x27;</span>,<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">plugins</span>:[<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(),<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModuleFederationPlugin</span>(&#123;<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;search&#x27;</span>,<br>            <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;remoteEntry.js&#x27;</span>,<br>            <span class="hljs-attr">remotes</span>: &#123;<br>                <span class="hljs-attr">nav</span>: <span class="hljs-string">&#x27;nav@http://localhost:3003/remoteEntry.js&#x27;</span>,<br>                <span class="hljs-attr">home</span>: <span class="hljs-string">&#x27;home@http://localhost:3001/remoteEntry.js&#x27;</span><br>            &#125;<br>        &#125;)<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291520476.png" srcset="/img/loading.gif" lazyload alt="image-20220529152048417"></p>
<h4 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h4><p>search应用导入nav应用  </p>
<p><code>import(&#39;nav/Header&#39;)</code>这个语句中 nav Header 怎么来的？</p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291523708.png" srcset="/img/loading.gif" lazyload alt="image-20220529152356649"></p>
<p><img src="https://raw.githubusercontent.com/Hbisedm/my-blob-picGo/main/img/202205291523658.png" srcset="/img/loading.gif" lazyload alt="image-20220529152324584"></p>
<h3 id="提升构建性能"><a href="#提升构建性能" class="headerlink" title="提升构建性能"></a>提升构建性能</h3><ul>
<li>通过webpack来提升项目性能（网站的首屏时间，用于C端用户）</li>
<li>提升编译性能（提高打包速度，降低打包时间，用于开发人员）下面的内容的关于这种</li>
</ul>
<p>三个环境提升构建性能</p>
<ul>
<li>通用环境</li>
<li>开发环境</li>
<li>生产环境</li>
</ul>
<h5 id="通用环境"><a href="#通用环境" class="headerlink" title="通用环境"></a>通用环境</h5><ol>
<li><p>提升环境版本，webpack、node版本</p>
</li>
<li><p>将loader应用于最少数量的必要模块</p>
</li>
<li><p>引导</p>
<ul>
<li>每个额外的loader、plugin都有启动时间，尽量少用</li>
</ul>
</li>
<li><p>解析</p>
<ul>
<li>减少 resolve.modules, resolve.extensions,resolve.mainFiles, resolve.descriptionFiles 中条目数量，因为他们会增加文件系统调用的次数。</li>
<li>如果你不使用 symlinks（例如 npm link 或者 yarn link），可以设置 resolve.symlinks: false。</li>
<li>如果你使用自定义 resolve plugin 规则，并且没有指定 context上下文，可以设置 resolve.cache WithContext: false。</li>
</ul>
</li>
<li><p>小就是快</p>
</li>
</ol>
<p>   减少编译结果的整体大小，以提高构建性能。尽量保持 chunk 体积小。</p>
<ul>
<li>使用数量更少&#x2F;体积更小的 library。</li>
<li>在多页面应用程序中使用 SplitChunksPlugin。</li>
<li>在多页面应用程序中使用 SplitChunksPlugin，并开启 async 模式。</li>
<li>移除未引用代码。</li>
<li>只编译你当前正在开发的那些代码。</li>
</ul>
<ol start="6">
<li><p>持久化缓存</p>
<ul>
<li>在webpack 配置中使用 cache 选项。使用 packagejson 中的”postinstall” 清除缓存目录。</li>
<li>将 cache 类型设置为内存或者文件系统。memory选项很简单，它告诉 webpack 在内存中存储缓存，不允许额外的配置：</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">cache</span>: &#123;<br>  	<span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;memory&#x27;</span>,<br>  &#125;，<br>&#125;；<br></code></pre></td></tr></table></figure>
</li>
<li><p>自定义loader&#x2F;plugin</p>
</li>
<li><p>dll</p>
</li>
<li><p>worker池（worker pool）</p>
</li>
</ol>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7/">打包工具</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/05/26/%E5%B7%A5%E4%BD%9C%E5%8C%BA/%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7/Vite/vite%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">vite的使用</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/05/22/%E5%B7%A5%E4%BD%9C%E5%8C%BA/%E5%B7%A5%E7%A8%8B%E5%8C%96/%E5%A6%82%E4%BD%95%E9%83%A8%E7%BD%B2/">
                        <span class="hidden-mobile"></span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"mGYDP7QqwA4Ca7dCSS9lwnFK-gzGzoHsz","appKey":"iJMI77yt31LAEc08kJwuT12Y","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          Fluid.plugins.initFancyBox('#valine .vcontent img:not(.vemoji)');
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- LeanCloud 统计PV -->
        <span id="leancloud-site-pv-container" style="display: none">
            总访问量 
            <span id="leancloud-site-pv"></span>
             次
          </span>
      
      
        <!-- LeanCloud 统计UV -->
        <span id="leancloud-site-uv-container" style="display: none">
            总访客数 
            <span id="leancloud-site-uv"></span>
             人
          </span>
      

    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  




  <script defer src="/js/leancloud.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>












  

  

  

  

  

  





<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
